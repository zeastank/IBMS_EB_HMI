var TcHmi;!function(e){!function(t){!function(o){o.SubjectInfosWithDialogs=[t.BA.SubjectInfos.HtgCrv,t.BA.SubjectInfos.HeatgCrv,t.BA.SubjectInfos.SpTRm,t.BA.SubjectInfos.SpRoomTemp],e.EventProvider.register(t.TcHmiBaEvents.onStartInitializing,(e=>{e.destroy(),o.Controls.Keyboard.updateLayout(),o.Controls.Keyboard.initKeyboard(),i()}));let n,i=()=>{e.EventProvider.register(t.Server.BaSite.Events.onExtensionLoaded,(async o=>{try{o.destroy();const n=await t.Storage.UserData.loadLastThemeAsync();let a=!0;if(null!=n){e.Theme.get()===n?a=!1:e.Theme.set(n)}let r=e.EventProvider.register(t.TcHmiEvents.onThemeDataChanged,(async()=>{try{a?a=!1:t.Storage.UserData.saveLastThemeAsync(e.Theme.get())}catch(e){t.BaseError.warn(e)}}));e.EventProvider.register("onWebSocketClosed",(e=>{e.destroy(),r(),i()}))}catch(e){t.BaseError.warn(e)}}))};!function(n){let i;!function(n){let i;function a(n){setTimeout((n=>{if(null==i)return;if(e.BuildingAutomation.Helper.Keyboard.isMobile())return;let a=e.Config.get().systemKeyboard;if(null!=a&&""!==a.providerName&&n!==("Visible"===i.getVisibility()))if(n){let e=$(window).width()||"0",n=$(window).height()||"0",a=o.Keyboard.InputType===t.DataType.string?"780px":"400px";i.getElement().css("--ba-width-window",e+"px"),i.getElement().css("--ba-height-window",n+"px"),i.getElement().css("--ba-width-kb",a),i.setVisibility("Visible")}else i.setVisibility("Collapsed")}),10,n)}n.ZIndex=o.OverlayContainerZIndex+1e3,n.initKeyboard=function(){if(null!=i)return;let r=e.View.get();null!=r&&(i=e.Controls.get("BaKeyboardGlobal"),null==i&&(i=e.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiKeyboard","BaKeyboardGlobal",null,r)),null!=i&&(t.Helper.DragableElement.makeDragable(i.getElement()),i.getElement().addClass("ba-kb-gl"),i.setScaleMode("ScaleToFill"),i.setVisibility("Collapsed"),i.setZindex(n.ZIndex),i.setLayoutFile(t.Helper.Keyboard.getLayoutPath()),$("body").append(i.getElement()),e.EventProvider.register(t.TcHmiEvents.onLocaleChanged,(()=>{null!=i&&i.setLayoutFile(t.Helper.Keyboard.getLayoutPath())})),e.EventProvider.register(e.BuildingAutomation.Components.InputBox.InputBoxEvents.onFocusIn,((n,...r)=>{if(!(r[0]instanceof e.BuildingAutomation.Components.InputBox))return;let l=r[0];l.getUsedDataType()!=o.Keyboard.InputType&&(o.Keyboard.InputType=l.getUsedDataType()||t.DataType.string,null!=i&&i.setLayoutFile(t.Helper.Keyboard.getLayoutPath())),a(!0)})),e.EventProvider.register(e.BuildingAutomation.Components.InputBox.InputBoxEvents.onFocusOut,((e,...t)=>{a(!1)})),e.EventProvider.register(e.BuildingAutomation.Components.InputBox.InputBoxEvents.onUserInteractionFinished,((e,...t)=>{a(!1)}))))},n.updateLayout=function(){let t=e.Locale.get();if(o.Keyboard.Layout=o.Locale.KBLayouts.English,null!=t){t+="-"+t.toLocaleUpperCase();for(let e in o.Locale.KBLayouts)if(t===o.Locale.KBLayouts[e]){o.Keyboard.Layout=t;break}}},n.setVisibilityKeyboard=a}(i=n.Keyboard||(n.Keyboard={}))}(n=o.Controls||(o.Controls={}))}(t.Globals||(t.Globals={}))}(e.BuildingAutomation||(e.BuildingAutomation={}))}(TcHmi||(TcHmi={}));