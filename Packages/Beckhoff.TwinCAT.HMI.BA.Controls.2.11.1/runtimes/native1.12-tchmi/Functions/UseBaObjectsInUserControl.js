var TcHmi;!function(e){!function(t){!function(n){function o(n,o,r){const a=o.AllParams.find((e=>e.InstanceName==r));let i;e.EventProvider.register(n.getId()+".onDestroyed",(e=>{e.destroy(),null!=i&&i()})),null!=a&&(n instanceof t.Controls.Common.Textblock?a.watch((e=>{n.setText(e)})):n instanceof t.Controls.Common.InputBox?a.DataType==t.DataType.number?(a.watch((e=>{n.setValue(e)})),t.BA.BaVariable.isIBaDecoratingParameterInfo(a.Info)?a.getDecoratingInfoAsync().then((e=>{null!=e&&"number"==typeof e&&n.setUnit(e)})).catch((e=>{t.BaseError.warn(e)})):t.BA.BaVariable.isIBaDecoratedParameterInfo(a.Info)&&n.setUnit(a.Info.Decorated),i=n.eventHandler.register(t.Components.InputBox.InputBoxEvents.onUserInteractionFinished,(()=>{a.write(n.getValue(),(e=>{t.Logger.checkServerResult(t.Logger.Severity.warn,e)}))}))):console.error("Not implemented DataType of BaVariable",a):n instanceof t.Controls.Common.Checkbox?a.DataType==t.DataType.boolean?(a.watch((e=>{n.setState(e)})),t.BA.BaVariable.isIBaEnumeratingParameterInfo(a.Info)?n.baObjectHandler.watchValueRange(a,(e=>{null!=e&&(n.setActiveText(e.get(1)),n.setInactiveText(e.get(0)))})):t.BA.BaVariable.isIBaEnumeratedParameterInfo(a.Info)&&(n.setActiveText(a.Info.Enumerated[1]),n.setInactiveText(a.Info.Enumerated[2])),i=n.eventHandler.register(t.Components.Checkbox.CheckboxEvents.onUserInteractionFinished,(()=>{a.write(n.getState(),(e=>{t.Logger.checkServerResult(t.Logger.Severity.warn,e)}))}))):console.error("Not implemented DataType of BaVariable",a):n instanceof t.Controls.Common.Combobox?a.DataType==t.DataType.enum?(a.watch((e=>{n.setSelectedValue(e)})),t.BA.BaVariable.isIBaEnumeratingParameterInfo(a.Info)?n.baObjectHandler.watchValueRange(a,(e=>{null!=e?n.setData(t.Components.Combobox.toComboboxItemArray(e)):console.warn(`Could not set state texts of ${n.getId()}!`)})):t.BA.BaVariable.isIBaEnumeratedParameterInfo(a.Info)&&n.setData(t.Components.Combobox.toComboboxItemArray(a.Info.Enumerated)),i=n.eventHandler.register(t.Components.Combobox.ComboboxEvents.onUserInteractionFinished,(()=>{a.write(n.getSelectedValue(),(e=>{t.Logger.checkServerResult(t.Logger.Severity.warn,e)}))}))):console.error("Not implemented handling of BaVariable!",a):console.error(`No BaVariable with name '${r}' in BaObject!`,o))}function r(n,o){if("function"!=typeof n.setBaObject)throw new Error("Nested TcHmiUserControl does not have a property BaObject!");t.BaObjectHandler.isIUsesBaObject(n)?n.baObjectHandler.setBaObject(o):n.setBaObject(new e.Symbol(o.getSymbolExpression().toString()))}function a(t){let n=[];const o=t.getChildren();for(let t=0;t<o.length;t++){const r=o[t];r instanceof e.Controls.System.TcHmiContainerControl?n=n.concat(a(r)):n.push(r)}return n}n.UseBaObjectsInUserControl=function(n,i){if(!(i instanceof e.Symbol))return;const s=".";if(!(n.getParent()instanceof e.Controls.System.TcHmiUserControlHost))throw new Error("Parent of TcHmiUserControl must be TcHmiUserControlHost!");const c=a(n);t.BaObjectHandler.readBaObject(i.getExpression().getName(),!0,!0).then((a=>{for(let m=0;m<c.length;m++){const f=c[m];if(t.BaObjectHandler.isIUsesBaObject(f)||f instanceof e.Controls.System.TcHmiUserControlHost){if(-1==f.getId().indexOf(n.getId()+"."))continue;let e=f.getId().replace(n.getId()+".","");const c=e.split(s);if("Root"==e||e.indexOf("Root.")>-1)if(e.indexOf(s)>-1){if(c.length>2){console.error('Only access a variable under the root element. E.g. "Root.sDescription".');continue}o(f,a,c[1])}else r(f,a);else if(e.indexOf(s)>-1){if(a instanceof t.BA.BaView){var i,l=a;do{if(e=c.shift(),i=void 0,l instanceof t.BA.BaView&&(i=l.Children.get(e)),null==i){if(0!=c.length){console.error("At this point you need to point to a BaVariable!");break}o(f,l,e)}else l=i,0==c.length&&r(f,l)}while(c.length>0)}else if(c.length>2)throw new Error("Bound BaObject is not a BaView and therefore a children BaObject can not be accessed")}else if(a instanceof t.BA.BaView){const t=a.Children.get(e);t&&r(f,t)}}}})).catch((e=>{t.BaseError.warn(e);const o=new t.Components.LegendIconHandler;t.Components.ErrorIndicator.appendErrorIndicator(n.getElement(),t.Components.ErrorIndicator.ErrorLevel.connection,o),o.show()}))}}(t.Functions||(t.Functions={}))}(e.BuildingAutomation||(e.BuildingAutomation={}))}(TcHmi||(TcHmi={})),TcHmi.Functions.registerFunctionEx("UseBaObjectsInUserControl","TcHmi.BuildingAutomation.Functions",TcHmi.BuildingAutomation.Functions.UseBaObjectsInUserControl);