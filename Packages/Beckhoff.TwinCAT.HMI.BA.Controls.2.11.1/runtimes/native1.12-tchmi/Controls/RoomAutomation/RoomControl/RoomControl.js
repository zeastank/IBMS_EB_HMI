var TcHmi;!function(t){!function(e){!function(n){!function(o){let s;o.showBusyIndicator=!1,o.ignoreBaObjectAccess=!1,o.showSlidersInControlUnitHeaders=!1,function(s){class i extends n.System.TextControl{constructor(t,n,o){super(t,n,o),this.__loadBaChildren=!0,this.resizeHandler=new e.Components.ResizeHandler(this),this.__roomStatus=new e.Components.ControlContainer(this.__id+"-room-status",this),this.__controlUnitHeader={},this.__controlUnits=[],this.__sideMenuOpen=!1,this.__ctrlCnt={sunblind:0,light:0,hc:0,window:0},this.__useCurrentValues=!1,this.__currentlyAddedControlUnits=[],this.__pressedHandler=t=>this.__onPressed(t),this.__windowPressedHandler=t=>this.__onWindowPressed(t)}get sideMenuOpen(){return this.__sideMenuOpen}__previnit(){super.__previnit(),this.baObjectHandler=new e.BaObjectHandler(this),this.eventHandler=new e.EventHandler(this),this.__presenceLegendIconHandler=new e.Components.LegendIconHandler(e.Icons.convertIIconDataToIIconAttributes(e.Icons.RoomAutomation.Presence)),this.__switchOffDelayLegendIconHandler=new e.Components.LegendIconHandler(e.Icons.convertIIconDataToIIconAttributes(e.Icons.RoomAutomation.SwitchOffDelay)),this.__roomStatusLightLegendIconHandler=new e.Components.LegendIconHandler(e.Icons.convertIIconDataToIIconAttributes(e.Icons.RoomAutomation.Lamp2)),this.__roomStatus.getElement().addClass("control-unit"),this.__element.append(this.__roomStatus.getElement())}__init(){super.__init()}__attach(){super.__attach(),this.__presenceLegendIconHandler.show(),this.__switchOffDelayLegendIconHandler.show(),e.Server.BaSite.UserManagement.checkAccess(n.System.BaseRoomControl.MinimumControlRole)?this.__element.on("pointerdown",this.__pressedHandler):this.setReadOnly(!0);let t=!1;null==this.__attrHandler.lights&&(this.__attrHandler.lights={}),void 0===this.__attrHandler.lights.baInterfaceSymbolNames&&(this.__attrHandler.lights.baInterfaceSymbolNames=o.Light.BaInterfaceSymbolNames,t=!0),null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),void 0===this.__attrHandler.sunblinds.baInterfaceSymbolNames&&(this.__attrHandler.sunblinds.baInterfaceSymbolNames=o.Sunblind.BaInterfaceSymbolNames,t=!0),null==this.__attrHandler.hcs&&(this.__attrHandler.hcs={}),void 0===this.__attrHandler.hcs.baInterfaceSymbolNames&&(this.__attrHandler.hcs.baInterfaceSymbolNames=o.HeatingCooling.BaInterfaceSymbolNames,t=!0),null==this.__attrHandler.windows&&(this.__attrHandler.windows={}),void 0===this.__attrHandler.windows.baInterfaceSymbolNames&&(this.__attrHandler.windows.baInterfaceSymbolNames=o.Window.BaInterfaceSymbolNames,t=!0),t&&(null!=this.baObjectHandler.baObject?this.processBaObject():this.__processControlUnits()),this.__processSwitchOffDelayActive(),this.__processPresence()}__detach(){super.__detach(),this.__presenceLegendIconHandler.hide(),this.__switchOffDelayLegendIconHandler.hide(),this.__roomStatusLightLegendIconHandler.hide(),this.__element.off("pointerdown",this.__pressedHandler),this.__sideMenu?.off("mousedown click touchstart",e.EventHandler.stopPropagationHandler),this.__sideMenu?.detach()}destroy(){this.__keepAlive||(this.__controlUnits.forEach((t=>t.destroy())),this.__headerSideMenu?.destroy(),this.__roomStatus.destroy(),this.__roomStatusSideMenu?.destroy(),this.__controlUnitHeader.light?.healine.destroy(),this.__controlUnitHeader.light?.controls?.destroy(),this.__controlUnitHeader.sunblind?.healine.destroy(),this.__controlUnitHeader.sunblind?.controls?.destroy(),this.__controlUnitHeader.hc?.healine.destroy(),this.__controlUnitHeader.hc?.controls?.destroy(),this.__controlUnitHeader.window?.healine.destroy(),this.__controlUnitHeader.window?.controls?.destroy(),this.resizeHandler.destroy(),this.baObjectHandler.destroy(),super.destroy())}onResized(){let t=this.__element.innerHeight(),e=0;if(this.__attrHandler.hideRoomStatus||(e=1),null!=t&&t>0){e+=this.__controlUnits.length;for(let t=0;t<this.__controlUnits.length;t++)(!this.__attrHandler.showLights&&this.__controlUnits[t]instanceof s.LightControl||!this.__attrHandler.showSunblinds&&this.__controlUnits[t]instanceof s.SunblindControl||!this.__attrHandler.showHeatingCoolings&&this.__controlUnits[t]instanceof s.HeatingCoolingControl||!this.__attrHandler.showWindows&&this.__controlUnits[t]instanceof s.WindowControl)&&e--;t/=e,t>40?this.__element.css("--control-unit-height","40px"):this.__element.css("--control-unit-height",t+"px")}}__onPressed(n){if(null!=n.button&&n.button!==e.MouseButtons.left)return;if(0==this.getIsEnabled()||0==t.Access.checkAccess(this,e.Server.AccessRight.operate))return;this.__element.addClass("down"),$(window).off("pointerdown",this.__windowPressedHandler);let o=()=>{this.__toggleMenu(),this.__element.off("pointerup",o)};this.__element.on("pointerup",o);let s=()=>{this.__element.removeClass("down"),$(window).off("pointerup",s),this.__element.off("pointerup",o)};$(window).on("pointerup",s)}__onWindowPressed(t){let e=$(t.target);e.hasClass("tchmi-ba-room-control-side-menu")||null!=e.parents(".tchmi-ba-room-control-side-menu")[0]||this.__toggleMenu()}onBrightnessChanged(){if(null==this.__attrHandler.lights)return;if(null==this.__attrHandler.lights.lightColor)return;if(this.__controlUnits.length<=0)return;let t;this.__roomStatus.getControl(i.__lightIconName)?.iconHandler.setIconColor(o.Light.LightOffColor),this.__roomStatusSideMenu?.getControl(i.__lightIconName)?.iconHandler.setIconColor(o.Light.LightOffColor);let e=null;for(let n=0;n<this.__controlUnits.length;n++){let r=this.__controlUnits[n];if(r instanceof s.LightControl&&(t=this.__useCurrentValues?r.getAttributes().brightness:null!=r.getAttributes().brightnessFeedback?r.getAttributes().brightnessFeedback:r.getAttributes().brightness,null!=t&&(null==e&&(e=0),null!=t&&("number"==typeof t&&t>o.Light.MinimumBrightness||"boolean"==typeof t&&!0===t)))){this.__roomStatus.getControl(i.__lightIconName)?.iconHandler.setIconColor(this.__attrHandler.lights.lightColor),this.__roomStatusSideMenu?.getControl(i.__lightIconName)?.iconHandler.setIconColor(this.__attrHandler.lights.lightColor),e++;break}}if(this.__sideMenu){let t=this.__controlUnitHeader.light?.controls?.getControl(i.__controlUnitHeaderSwitchName);null!=e&&t?.setState(0!==e)}this.__useCurrentValues=!1}onWindowPositionChanged(){if(null==this.__attrHandler.windows)return;if(this.__controlUnits.length<=0)return;let t,e=null;for(let n=0;n<this.__controlUnits.length;n++){let i=this.__controlUnits[n];if(i instanceof s.WindowControl&&(t=this.__useCurrentValues?i.getAttributes().position:null!=i.getAttributes().positionFeedback?i.getAttributes().positionFeedback:i.getAttributes().position,null!=t&&(null==e&&(e=0),null!=t&&("number"==typeof t&&t>o.Window.ClosePosition||"boolean"==typeof t&&!0===t)))){e++;break}}if(this.__sideMenu){let t=this.__controlUnitHeader.window?.controls?.getControl(i.__controlUnitHeaderSwitchName);null!=e&&t?.setState(0!==e)}this.__useCurrentValues=!1}onPriorityChanged(){let t,n,o=99,s=null,r=!1;for(let e=0;e<this.__controlUnits.length;e++)t=this.__controlUnits[e],n=t.getAttributes().priority,null!=n&&0!=n&&n<o&&(o=n,s=e),t.hasManualPriority()&&t.hasResetManualSymbol()&&(r=!0);if(null!=s){t=this.__controlUnits[s];let n=t.getPriorityIcon(o);null==n?(this.__roomStatus.getControl(i.__priorityIconName)&&this.__roomStatus.removeControl(i.__priorityIconName),this.__sideMenu&&this.__roomStatusSideMenu?.getControl(i.__priorityIconName)&&this.__roomStatusSideMenu?.removeControl(i.__priorityIconName)):(null==this.__roomStatus.getControl(i.__priorityIconName)&&this.__roomStatus.addControl({type:e.Components.ComponentType.Icon,name:i.__priorityIconName,settings:{cssClass:"fixed-size",hide:this.__attrHandler.showRoomName,order:2}}),this.__sideMenu&&null==this.__roomStatusSideMenu?.getControl(i.__priorityIconName)&&this.__roomStatusSideMenu?.addControl({type:e.Components.ComponentType.Icon,name:i.__priorityIconName,settings:{cssClass:"fixed-size",order:2}}),this.__roomStatus.getControl(i.__priorityIconName)?.iconHandler.setAttributes(n),this.__roomStatusSideMenu?.getControl(i.__priorityIconName)?.iconHandler.setAttributes(n))}else this.__roomStatus.getControl(i.__priorityIconName)&&this.__roomStatus.removeControl(i.__priorityIconName),this.__sideMenu&&this.__roomStatusSideMenu?.getControl(i.__priorityIconName)&&this.__roomStatusSideMenu?.removeControl(i.__priorityIconName);r?this.__roomStatusSideMenu&&null==this.__roomStatusSideMenu.getControl(i.__resetManualButtonName)&&this.__roomStatusSideMenu.addControl({type:e.Components.ComponentType.Button,name:i.__resetManualButtonName,settings:{iconPath:e.Icons.RoomAutomation.ResetManual.path,iconHeight:70,iconHeightUnit:"%",iconWidth:70,iconWidthUnit:"%",cssClass:"fixed-size",order:5},callback:()=>{for(let t of this.__controlUnits)t.resetManualToPlc()}}):this.__roomStatusSideMenu&&this.__roomStatusSideMenu.getControl(i.__resetManualButtonName)&&this.__roomStatusSideMenu?.removeControl(i.__resetManualButtonName)}async __addControlUnit(n,o){let i=null,l=!1;try{n.type=await this.__detectControlUnitType(n)}catch(t){t instanceof e.BaseError?t.logWarn():e.Logger.warn(t)}switch(n.type){case r.sunblind:let t=this.childrenHandler.getChildren().get(this.__id+"-sunblind-control-unit-"+this.__ctrlCnt.sunblind);t||(l=!0,t=new s.SunblindControl(this.__id+"-sunblind-control-unit-"+this.__ctrlCnt.sunblind,this),t.setAttributes({usePosition:this.__attrHandler.sunblinds?.usePosition,useAngle:this.__attrHandler.sunblinds?.useAngle,angleStep:this.__attrHandler.sunblinds?.angleStep}),t.createElement()),i=t,null!=this.__attrHandler.sunblinds?.baInterfaceSymbolNames&&(t.baInterfaceHandler.baInterfaceSymNames=this.__attrHandler.sunblinds?.baInterfaceSymbolNames),this.__ctrlCnt.sunblind++;break;case r.light:let e=this.childrenHandler.getChildren().get(this.__id+"-light-control-unit-"+this.__ctrlCnt.light);e||(l=!0,e=new s.LightControl(this.__id+"-light-control-unit-"+this.__ctrlCnt.light,this),e.setAttributes({lightColor:this.__attrHandler.lights?.lightColor})),i=e,null!=n.displayMode&&(n.displayMode=Number(n.displayMode)),null!=this.__attrHandler.lights?.baInterfaceSymbolNames&&(e.baInterfaceHandler.baInterfaceSymNames=this.__attrHandler.lights?.baInterfaceSymbolNames),this.__ctrlCnt.light++;break;case r.hc:let o=this.childrenHandler.getChildren().get(this.__id+"-hc-control-unit-"+this.__ctrlCnt.hc);o||(l=!0,o=new s.HeatingCoolingControl(this.__id+"-hc-control-unit-"+this.__ctrlCnt.hc,this),o.setAttributes({roomTempAdjustRange:this.__attrHandler.hcs?.roomTempAdjustRange,unit:this.__attrHandler.hcs?.unit}),o.createElement()),i=o,null!=this.__attrHandler.hcs?.baInterfaceSymbolNames&&(o.baInterfaceHandler.baInterfaceSymNames=this.__attrHandler.hcs?.baInterfaceSymbolNames),this.__ctrlCnt.hc++;break;case r.window:let a=this.childrenHandler.getChildren().get(this.__id+"-window-control-unit-"+this.__ctrlCnt.window);a||(l=!0,a=new s.WindowControl(this.__id+"-window-control-unit-"+this.__ctrlCnt.window,this),a.createElement()),i=a,null!=n.displayMode&&(n.displayMode=Number(n.displayMode)),null!=this.__attrHandler.windows?.baInterfaceSymbolNames&&(a.baInterfaceHandler.baInterfaceSymNames=this.__attrHandler.windows?.baInterfaceSymbolNames),this.__ctrlCnt.window++;break;default:this.logger.warn("Invalid ControlUnitType",n)}i&&(i.setAttributes(n),null!=n.baInterface&&i.setBaInterface(new t.Symbol(n.baInterface)),i.getElement().css("order",o+1),l&&this.__controlUnits.push(i))}__createSideMenu(){this.__sideMenu=$("<div>").addClass("tchmi-ba-room-control-side-menu"),this.__sideMenu.on("mousedown click touchstart",e.EventHandler.stopPropagationHandler),this.__sideControlContainer=$("<div>").addClass("side-control-container last"),this.__headerSideMenu=new e.Components.ControlContainer(this.__id+"-header-side-menu",this);let t={type:e.Components.ComponentType.Button,callback:()=>{this.__toggleMenu()},settings:{iconPath:e.Icons.Standard.Right.path,cssClass:"fixed-size"}},n={type:e.Components.ComponentType.Textblock,name:i.__headlineSideMenuName,settings:{textAttributes:{text:this.__attrHandler.name?this.__attrHandler.name:"",horizontalAlignment:"Center"}}};this.__headerSideMenu.setControlsHorizonzalAlignment("Left"),this.__headerSideMenu.addControls([t,n]),this.__sideControlContainer.append(this.__headerSideMenu.getElement()),this.__processSideMenuHeader(),this.__roomStatusSideMenu=new e.Components.ControlContainer(this.__id+"-room-status-side-menu",this),this.__ctrlCnt.light>0&&this.__roomStatusSideMenu.addControl({type:e.Components.ComponentType.Icon,name:i.__lightIconName,settings:{iconPath:e.Icons.RoomAutomation.Lamp2.path,iconHeight:100,iconHeightUnit:"%",iconWidth:100,iconWidthUnit:"%",cssClass:"fixed-size"}}),this.__sideControlContainer.append(this.__roomStatusSideMenu.getElement()),this.onPriorityChanged(),this.onBrightnessChanged(),this.__processSwitchOffDelayActive(),this.__processPresence(),this.__sideMenu.append(this.__sideControlContainer),this.__processRoomStatus();let o=!1;for(let t=0;t<this.__controlUnits.length;t++)if(this.__controlUnits[t]instanceof s.LightControl){o||(this.__controlUnitHeader.light||(this.__controlUnitHeader.light=this.__createControlUnitHeader(r.light)),this.__sideMenu.append(this.__controlUnitHeader.light.healine.getElement()),this.__controlUnitHeader.light.controls&&this.__sideMenu.append(this.__controlUnitHeader.light.controls.getElement()),o=!0);let e=this.__controlUnits[t];e.getSideControl().removeClass("last"),this.__sideMenu.append(e.getSideControl())}this.__sideMenu.children().last().addClass("last"),o=!1;for(let t=0;t<this.__controlUnits.length;t++)if(this.__controlUnits[t]instanceof s.SunblindControl){o||(this.__controlUnitHeader.sunblind||(this.__controlUnitHeader.sunblind=this.__createControlUnitHeader(r.sunblind)),this.__sideMenu.append(this.__controlUnitHeader.sunblind.healine.getElement()),this.__controlUnitHeader.sunblind.controls&&this.__sideMenu.append(this.__controlUnitHeader.sunblind.controls.getElement()),o=!0);let e=this.__controlUnits[t];e.getElement().removeClass("last"),this.__sideMenu.append(e.getSideControl())}this.__sideMenu.children().last().addClass("last"),o=!1;for(let t=0;t<this.__controlUnits.length;t++)if(this.__controlUnits[t]instanceof s.HeatingCoolingControl){o||(this.__controlUnitHeader.hc||(this.__controlUnitHeader.hc=this.__createControlUnitHeader(r.hc)),this.__sideMenu.append(this.__controlUnitHeader.hc.healine.getElement()),o=!0);let e=this.__controlUnits[t];e.getElement().removeClass("last"),this.__sideMenu.append(e.getSideControl())}this.__sideMenu.children().last().addClass("last"),o=!1;for(let t=0;t<this.__controlUnits.length;t++)if(this.__controlUnits[t]instanceof s.WindowControl){o||(this.__controlUnitHeader.window||(this.__controlUnitHeader.window=this.__createControlUnitHeader(r.window)),this.__sideMenu.append(this.__controlUnitHeader.window.healine.getElement()),this.__controlUnitHeader.window.controls&&this.__sideMenu.append(this.__controlUnitHeader.window.controls.getElement()),o=!0);let e=this.__controlUnits[t];e.getSideControl().removeClass("last"),this.__sideMenu.append(e.getSideControl())}this.__sideMenu.children().last().addClass("last");this.busyHandler.checkForBusyChildren((()=>{this.__sideMenu&&e.BusyHandler.detachBusyIndicator(this.__sideMenu)}))&&e.BusyHandler.appendBusyIndicator(this.__sideMenu)}__createControlUnitHeader(t){let n=this.__id+"-"+r[t]+"-header",l=this.__controlUnitHeader[r[t]]?.headline,a=this.__controlUnitHeader[r[t]]?.controls;if(!l){switch(this.__controlUnitHeader[r[t]]={},l=this.__createHeadlineContainer(n,t),this.__controlUnitHeader[r[t]].headline=l,t){case r.light:case r.window:if(!a){a=new e.Components.ControlContainer(n+"-controls",this),a.getElement().addClass("control-units-header controls");let s=(t,e)=>{let n=100;switch(t){case r.light:n=o.Light.MaximumBrightness-o.Light.MinimumBrightness,this.setAllLights(n*e+o.Light.MinimumBrightness);break;case r.window:null!=o.Window.ClosePosition&&null!=o.Window.OpenPosition&&(n=o.Window.OpenPosition-o.Window.ClosePosition,this.setAllWindows(n*e+o.Window.ClosePosition))}};o.showSlidersInControlUnitHeaders&&a.addControl({type:e.Components.ComponentType.Slider,name:i.__controlUnitHeaderSliderName,settings:{layout:{maxWidth:80,maxHeight:10,minHeight:10},knobAppearance:e.Components.Slider.KnobAppearance.round},callback:e=>{t===r.light?this.setAllLights(e):this.setAllWindows(e)}}),a.addControls([{type:e.Components.ComponentType.Button,callback:()=>{s(t,1/4)}},{type:e.Components.ComponentType.Button,callback:()=>{s(t,.5)}},{type:e.Components.ComponentType.Button,callback:()=>{s(t,3/4)}},{type:e.Components.ComponentType.Checkbox,name:i.__controlUnitHeaderSwitchName,settings:{appearance:e.Components.Checkbox.Appearance.toggleSlider,readOnly:!1,layout:{maxHeight:25,minHeight:25,maxWidth:35,minWidth:35}},callback:e=>{t===r.light?this.setAllLights(e):this.setAllWindows(e)}}])}this.onBrightnessChanged();break;case r.sunblind:a||(a=new e.Components.ControlContainer(n+"-controls",this).setAttributes({cssClass:"control-units-header controls"}),o.showSlidersInControlUnitHeaders&&a.addControl({type:e.Components.ComponentType.Slider,name:"position-slider",settings:{layout:{maxWidth:80,maxHeight:19,minHeight:19},knobAppearance:e.Components.Slider.KnobAppearance.rectangle},callback:t=>{this.__controlUnits.forEach((e=>{e instanceof s.SunblindControl&&e.writePosition(t)}))},cbOnCreated:t=>{this.__destroyersToCallOnDestroy.push(e.Locale.Localization.watchText(e.Locale.LangKey.Position,(n=>{e.Logger.checkServerResult(e.Logger.Severity.warn,n)&&t.textHandler.setText(n.text)})))}}),a.addControls([{type:e.Components.ComponentType.Button,name:"position-down-button",settings:{cssClass:"fixed-size",iconPath:e.Icons.Standard.Down.path},callback:()=>{this.__controlUnits.forEach((t=>{t instanceof s.SunblindControl&&t.writeCloseToPlc()})),a?.getControl("position-slider")?.setValue(o.Sunblind.ClosePosition)}},{type:e.Components.ComponentType.Button,name:"position-up-button",settings:{cssClass:"fixed-size",iconPath:e.Icons.Standard.Up.path},callback:()=>{this.__controlUnits.forEach((t=>{t instanceof s.SunblindControl&&t.writeOpenToPlc()})),a?.getControl("position-slider")?.setValue(o.Sunblind.OpenPosition)}}]),this.__attrHandler.sunblinds?.useAngle&&(o.Sunblind.UseButtonsForAngle?a.addControls([{type:e.Components.ComponentType.Button,name:"angle-minus-button",settings:{cssClass:"fixed-size",iconPath:e.Icons.RoomAutomation.SunblindAngleAdjustmentDown.path},callback:()=>{let t=0;if(this.__controlUnits.forEach((e=>{if(e instanceof s.SunblindControl){if(t=e.getAngle(),null!=t)return;t=0}})),null!=t){let e=t-(null!=this.__attrHandler.sunblinds?.angleStep?this.__attrHandler.sunblinds.angleStep:5);o.Sunblind.MaximumAngle>o.Sunblind.MinimumAngle?e<o.Sunblind.MinimumAngle&&(e=o.Sunblind.MinimumAngle):e<o.Sunblind.MaximumAngle&&(e=o.Sunblind.MaximumAngle),this.__controlUnits.forEach((t=>{t instanceof s.SunblindControl&&t.writeAngle(e)}))}}},{type:e.Components.ComponentType.Button,name:"angle-plus-button",settings:{cssClass:"fixed-size",iconPath:e.Icons.RoomAutomation.SunblindAngleAdjustmentUp.path},callback:()=>{let t=0;if(this.__controlUnits.forEach((e=>{if(e instanceof s.SunblindControl){if(t=e.getAngle(),null!=t)return;t=0}})),null!=t){let e=t+(null!=this.__attrHandler.sunblinds?.angleStep?this.__attrHandler.sunblinds?.angleStep:5);o.Sunblind.MaximumAngle>o.Sunblind.MinimumAngle?e>o.Sunblind.MaximumAngle&&(e=o.Sunblind.MaximumAngle):e>o.Sunblind.MinimumAngle&&(e=o.Sunblind.MinimumAngle),this.__controlUnits.forEach((t=>{t instanceof s.SunblindControl&&t.writeAngle(e)}))}}}]):a.addControl({type:e.Components.ComponentType.Slider,name:"angle-slider",settings:{layout:{maxWidth:80,maxHeight:19,minHeight:19},knobAppearance:e.Components.Slider.KnobAppearance.rectangle},callback:t=>{this.__controlUnits.forEach((e=>{e instanceof s.SunblindControl&&e.writeAngle(t)}))},cbOnCreated:t=>{this.__destroyersToCallOnDestroy.push(e.Locale.Localization.watchText(e.Locale.LangKey.Angle,(n=>{e.Logger.checkServerResult(e.Logger.Severity.warn,n)&&t.textHandler.setText(n.text)})))}})))}this.__controlUnitHeader[r[t]].controls=a,this.__updateControlUnitHeader(t)}return{healine:l,controls:a}}__createHeadlineContainer(t,n){let o=new e.Components.ControlContainer(t+"-headline",this);o.getElement().addClass("control-units-header headline");let s={type:e.Components.ComponentType.Textblock,cbOnCreated:t=>{let o;switch(n){case r.light:o=e.Locale.LangKey.Lights;break;case r.sunblind:o=e.Locale.LangKey.Shading;break;case r.hc:o=e.Locale.LangKey.HeatingCoolings;break;case r.window:o=e.Locale.LangKey.Windows;break;default:o=e.Locale.LangKey.invalid}this.__destroyersToCallOnDestroy.push(e.Locale.Localization.watchText(o,(n=>{e.Logger.checkServerResult(e.Logger.Severity.warn,n)&&t.textHandler.setText(n.text)})))}};return o.addControl(s).getElement().on("click touchstart",(t=>{for(let t=0;t<this.__controlUnits.length;t++)if(this.__controlUnits[t].getAttributes().type===n){this.__controlUnits[t].getSideControl().toggleClass("collapse")}let e=this.__controlUnitHeader[r[n]]?.controls;o?.getElement().hasClass("collapse")?(o?.getElement().removeClass("collapse"),e?.getElement().removeClass("collapse")):(setTimeout((()=>{o?.getElement().addClass("collapse")}),300),e?.getElement().addClass("collapse"))})),o}__updateControlUnitHeader(n){let s=this.__controlUnitHeader[r[n]]?.controls;if(null!=s)switch(n){case r.light:case r.window:if(o.showSlidersInControlUnitHeaders){let t=s.getControl(i.__controlUnitHeaderSliderName);if(null==t)throw new Error("Slider not available");t.setMinValue(n===r.light?o.Light.MinimumBrightness:o.Window.ClosePosition),t.setMaxValue(n===r.light?o.Light.MaximumBrightness:o.Window.OpenPosition)}for(let i=o.showSlidersInControlUnitHeaders?1:0;i<s.getControls().length-1;i++){let l=s.getControls()[i];l.setAttributes({layout:{maxWidth:30}});let a=100;switch(n){case r.light:if(this.__attrHandler.lights?.lightColor){a=o.Light.MaximumBrightness-o.Light.MinimumBrightness;let t=0;switch(i){case 1:t=a/4+o.Light.MinimumBrightness;break;case 2:t=a/2+o.Light.MinimumBrightness;break;case 3:t=3*a/4+o.Light.MinimumBrightness}l.setAttributes({iconPath:e.Icons.RoomAutomation.Lamp2.path,iconHeight:90,iconHeightUnit:"%",iconWidth:90,iconWidthUnit:"%",iconColor:e.Color.getFadeColor(o.Light.LightOffColor,o.Light.MinimumBrightness,this.__attrHandler.lights.lightColor,o.Light.MaximumBrightness,t)})}break;case r.window:switch(a=o.Window.OpenPosition-o.Window.ClosePosition,i){case 1:l.getElement().css("--tchmi-ba-window-position",10);break;case 2:l.getElement().css("--tchmi-ba-window-position",20);break;case 3:l.getElement().css("--tchmi-ba-window-position",30)}l.setAttributes({iconPath:t.Controls.getBasePath("TcHmi.BuildingAutomation.Controls.RoomAutomation.Window")+"/Images/RoofDome_small.svg",iconHeight:90,iconHeightUnit:"%",iconWidth:90,iconWidthUnit:"%"})}}break;case r.sunblind:if(o.showSlidersInControlUnitHeaders){let t=s.getControl("position-slider");if(null==t)throw new Error("Position slider not available");t.setMinValue(o.Sunblind.ClosePosition),t.setMaxValue(o.Sunblind.OpenPosition),t.setValue(o.Sunblind.ClosePosition)}if(this.__attrHandler.sunblinds?.useAngle&&!o.Sunblind.UseButtonsForAngle){let t=s.getControl("angle-slider");if(null==t)throw new Error(this.logger.error("Position slider could not be created!"));t.setMinValue(o.Sunblind.MinimumAngle),t.setMaxValue(o.Sunblind.MaximumAngle)}}}__destroySideMenu(){this.__headerSideMenu?.destroy(),delete this.__headerSideMenu,this.__roomStatusSideMenu?.destroy(),delete this.__roomStatusSideMenu,this.__sideMenu?.detach(),delete this.__sideMenu,this.__sideMenuOpen=!1,this.__controlUnitHeader.light?.healine.destroy(),this.__controlUnitHeader.light?.controls?.destroy(),this.__controlUnitHeader.sunblind?.healine.destroy(),this.__controlUnitHeader.sunblind?.controls?.destroy(),this.__controlUnitHeader.hc?.healine.destroy(),this.__controlUnitHeader.hc?.controls?.destroy(),$(window).off("pointerdown",this.__windowPressedHandler)}__toggleMenu(){this.__sideMenuOpen?(this.__sideMenu&&this.__sideMenu.animate({width:"0"},200,(()=>{this.__sideMenu&&!this.__sideMenuOpen&&this.__sideMenu.detach(),this.eventHandler.raise(i.ControlEvents.onSideMenuClosed)})),this.__sideMenuOpen=!1,$(window).off("pointerdown",this.__windowPressedHandler)):(this.__sideMenu||this.__createSideMenu(),$("body").append(this.__sideMenu),this.__sideMenu.animate({width:"300px"},200,(()=>{this.__sideMenuOpen&&($(window).on("pointerdown",this.__windowPressedHandler),this.eventHandler.raise(i.ControlEvents.onSideMenuOpened))})),this.__sideMenuOpen=!0)}async __detectControlUnitType(n){const s="No ControlUnitType detected!";return new Promise((async(i,l)=>{if(null!=n.type)return i(n.type);if(null!=n.baObject)e.BaObjectHandler.resolveBaObject(n.baObject).then((t=>t instanceof e.BA.BaBasicObject?(n.baObject=t,null!=this.__attrHandler.lights?.baInterfaceSymbolNames&&n.baObject.checkParams(o.Light.BaInterfaceDef,this.__attrHandler.lights.baInterfaceSymbolNames)?i(r.light):null!=this.__attrHandler.sunblinds?.baInterfaceSymbolNames&&n.baObject.checkParams(o.Sunblind.BaInterfaceDef,this.__attrHandler.sunblinds.baInterfaceSymbolNames)?i(r.sunblind):null!=this.__attrHandler.hcs?.baInterfaceSymbolNames&&n.baObject.checkParams(o.HeatingCooling.BaInterfaceDef,this.__attrHandler.hcs.baInterfaceSymbolNames)?i(r.hc):null!=this.__attrHandler.windows?.baInterfaceSymbolNames&&n.baObject.checkParams(o.Window.BaInterfaceDef,this.__attrHandler.windows.baInterfaceSymbolNames)?i(r.window):i(r.invalid)):l(s))).catch((t=>l(t)));else{if(null==n.baInterface)return void 0!==n.brightness||void 0!==n.brightnessFeedback?i(r.light):void 0!==n.position||void 0!==n.positionFeedback?i(r.sunblind):void 0!==n.roomTemp?i(r.hc):void 0!==n.windowPosition||void 0!==n.windowPositionFeedback?(n.position=n.windowPosition,n.positionFeedback=n.windowPositionFeedback,i(r.window)):l(s);if("string"==typeof n.baInterface){new t.Symbol(n.baInterface).resolveSchema((t=>{if(!this.logger.checkServerResult(e.Logger.Severity.warn,t)||null==t.schema)return i(r.invalid);if(null!=this.__attrHandler.lights?.baInterfaceSymbolNames){let n=e.BaInterfaceHandler.joinDefAndDesc(o.Light.BaInterfaceDef,this.__attrHandler.lights.baInterfaceSymbolNames);if(e.BaInterfaceHandler.validateSchema(t.schema,n))return i(r.light)}if(null!=this.__attrHandler.sunblinds?.baInterfaceSymbolNames){let n=e.BaInterfaceHandler.joinDefAndDesc(o.Sunblind.BaInterfaceDef,this.__attrHandler.sunblinds.baInterfaceSymbolNames);if(e.BaInterfaceHandler.validateSchema(t.schema,n))return i(r.sunblind)}if(null!=this.__attrHandler.hcs?.baInterfaceSymbolNames){let n=e.BaInterfaceHandler.joinDefAndDesc(o.HeatingCooling.BaInterfaceDef,this.__attrHandler.hcs.baInterfaceSymbolNames);if(e.BaInterfaceHandler.validateSchema(t.schema,n))return i(r.hc)}if(null!=this.__attrHandler.windows?.baInterfaceSymbolNames){let n=e.BaInterfaceHandler.joinDefAndDesc(o.Window.BaInterfaceDef,this.__attrHandler.windows.baInterfaceSymbolNames);if(e.BaInterfaceHandler.validateSchema(t.schema,n))return i(r.window)}return i(r.invalid)}))}}}))}__processRoomStatus(){null==this.__attrHandler.presence&&null==this.__attrHandler.switchOffDelayActive&&null==this.__roomStatusSideMenu?.getControl(i.__priorityIconName)&&null==this.__roomStatusSideMenu?.getControl(i.__lightIconName)?(this.__roomStatusSideMenu?.hide(),this.__headerSideMenu?.getElement().addClass("last")):(this.__roomStatusSideMenu?.show(),this.__headerSideMenu?.getElement().removeClass("last"))}__processSideMenuHeader(){let t=!1;if(this.__controlUnits.forEach((e=>{e.baObjectHandler.baObject&&(t=!0)})),t&&this.__headerSideMenu&&e.Server.BaSite.UserManagement.checkAccess(e.BA.Role.eAdvanced)&&null==this.__headerSideMenu.getControl(i.__openBaObjectListButtonName)){let t={type:e.Components.ComponentType.Button,name:i.__openBaObjectListButtonName,callback:()=>{let t={Children:new Map};for(let e=0;e<this.__controlUnits.length;e++){let n=this.__controlUnits[e].baObjectHandler.baObject;n&&t.Children.set(n.InstancePath,n)}let n=new e.Navigation.ProjectNavigationList(this.__id+"-view-list",this).setAttributes({valueHandler:{autoWrite:!0}});n.setData(t),n.getElement().css({position:"relative",height:"100%",width:"100%"});let o={appearance:{headline:{textAttributes:{text:this.__attrHandler.name?this.__attrHandler.name:""}},content:n.getElement(),modal:!1,layout:{maxWidth:s.DefaultBaObjectListDialogWidth},buttons:e.Components.DialogWindow.Buttons.CancelSize},callbacks:{cbClosed:()=>{n.destroy()}},behaviour:{destroyOnClose:!0}};e.Components.DialogWindow.createDialogWindow(o)?.open()},settings:{iconPath:e.Icons.ObjectType.Object.path,cssClass:"fixed-size"}};this.__headerSideMenu.addControl(t)}}__processShowControlUnits(){this.__controlUnits.forEach((t=>{t instanceof s.LightControl?this.__attrHandler.showLights?(t.createElement(),0==t.getIsAttached()&&this.__element.append(t.getElement())):t.getElement().detach():t instanceof s.SunblindControl?this.__attrHandler.showSunblinds?(t.createElement(),0==t.getIsAttached()&&this.__element.append(t.getElement())):t.getElement().detach():t instanceof s.HeatingCoolingControl?this.__attrHandler.showHeatingCoolings?(t.createElement(),0==t.getIsAttached()&&this.__element.append(t.getElement())):t.getElement().detach():t instanceof s.WindowControl&&(this.__attrHandler.showWindows?(t.createElement(),0==t.getIsAttached()&&this.__element.append(t.getElement())):t.getElement().detach())})),this.__updateControlHeight()}__updateControlHeight(){let t=0;this.__attrHandler.hideRoomStatus||(t=1),t+=this.__controlUnits.length;for(let e=0;e<this.__controlUnits.length;e++)(!this.__attrHandler.showLights&&this.__controlUnits[e]instanceof s.LightControl||!this.__attrHandler.showSunblinds&&this.__controlUnits[e]instanceof s.SunblindControl||!this.__attrHandler.showHeatingCoolings&&this.__controlUnits[e]instanceof s.HeatingCoolingControl||!this.__attrHandler.showWindows&&this.__controlUnits[e]instanceof s.WindowControl)&&t--;this.setHeight(30*t)}processBaObject(){if(null==this.__attrHandler.lights?.baInterfaceSymbolNames||null==this.__attrHandler.sunblinds?.baInterfaceSymbolNames||null==this.__attrHandler.hcs?.baInterfaceSymbolNames||null==this.__attrHandler.windows?.baInterfaceSymbolNames)return;if(null==this.baObjectHandler.baObject||!(this.baObjectHandler.baObject instanceof e.BA.BaView))return;let t=[];this.baObjectHandler.tryWatchChildrenBaVariable(this.baObjectHandler.baObject,e.BA.BaParameterId.eInstDescription,(t=>{this.setName(t)}));let n=this.busyHandler.setBusy("Getting control units from BaObject.");if(null!=this.__attrHandler.lights?.baInterfaceSymbolNames){let n=e.BA.BaView.getTemplates(this.baObjectHandler.baObject,o.Light.BaInterfaceDef,this.__attrHandler.lights.baInterfaceSymbolNames);for(let e=0;e<n.length;e++)t.push({type:r.light,baObject:n[e]})}if(null!=this.__attrHandler.sunblinds?.baInterfaceSymbolNames){let n=e.BA.BaView.getTemplates(this.baObjectHandler.baObject,o.Sunblind.BaInterfaceDef,this.__attrHandler.sunblinds.baInterfaceSymbolNames);for(let e=0;e<n.length;e++)t.push({type:r.sunblind,baObject:n[e]})}if(null!=this.__attrHandler.hcs?.baInterfaceSymbolNames){let n=e.BA.BaView.getTemplates(this.baObjectHandler.baObject,o.HeatingCooling.BaInterfaceDef,this.__attrHandler.hcs.baInterfaceSymbolNames);for(let e=0;e<n.length;e++)t.push({type:r.hc,baObject:n[e]})}if(null!=this.__attrHandler.windows?.baInterfaceSymbolNames){let n=e.BA.BaView.getTemplates(this.baObjectHandler.baObject,o.Window.BaInterfaceDef,this.__attrHandler.windows.baInterfaceSymbolNames);for(let e=0;e<n.length;e++)t.push({type:r.window,baObject:n[e]})}this.setControlUnits(t),n()}setAllLights(t){let e;for(let n=0;n<this.__controlUnits.length;n++)e=this.__controlUnits[n],this.__useCurrentValues=!0,e instanceof s.LightControl&&("boolean"==typeof e.getAttributes().brightness?t?e.writeBrightness(!0):e.writeBrightness(!1):"number"==typeof e.getAttributes().brightness&&("boolean"==typeof t?t?e.writeBrightness(o.Light.MaximumBrightness):e.writeBrightness(o.Light.MinimumBrightness):e.writeBrightness(t)))}setAllWindows(t){let e;for(let n=0;n<this.__controlUnits.length;n++)e=this.__controlUnits[n],this.__useCurrentValues=!0,e instanceof s.WindowControl&&("boolean"==typeof e.getAttributes().position?t?e.writePositionToPlc(!0):e.writePositionToPlc(!1):"number"==typeof e.getAttributes().position&&("boolean"==typeof t?t?e.writePositionToPlc(o.Window.OpenPosition):e.writePositionToPlc(o.Window.ClosePosition):e.writePositionToPlc(t)))}setAllSunblinds(t,e){let n;for(let o=0;o<this.__controlUnits.length;o++)n=this.__controlUnits[o],n instanceof s.SunblindControl&&(n.writePosition(t),n.writeAngle(e))}showTemperatureDisplays(t){this.__controlUnits.forEach((t=>{t instanceof s.HeatingCoolingControl&&t.showRoomTemperature()})),null!=t&&setTimeout((()=>{this.hideTemperatureDisplays()}),1e3*t)}hideTemperatureDisplays(){this.__controlUnits.forEach((t=>{t instanceof s.HeatingCoolingControl&&t.hideRomTemperature()}))}setBaObject(t){return this.baObjectHandler.setBaObject(t),this}getBaObject(){return this.baObjectHandler.baObject}setAttributes(t){return super.setAttributes(t),void 0!==t.name&&this.setName(t.name),void 0!==t.controlUnitOptions&&this.setControlUnits(t.controlUnitOptions),void 0!==t.presence&&this.setPresence(t.presence),void 0!==t.switchOffDelayActive&&this.setSwitchOffDelayActive(t.switchOffDelayActive),void 0!==t.hideRoomStatus&&this.setHideRoomStatus(t.hideRoomStatus),void 0!==t.showRoomName&&this.setShowRoomName(t.showRoomName),void 0!==t.showLights&&this.setShowLights(t.showLights),void 0!==t.lights?.lightColor&&this.setLightColor(t.lights.lightColor),void 0!==t.showSunblinds&&this.setShowSunblinds(t.showSunblinds),void 0!==t.sunblinds?.useAngle&&this.setUseAngle(t.sunblinds.useAngle),void 0!==t.sunblinds?.angleStep&&this.setAngleStep(t.sunblinds.angleStep),void 0!==t.sunblinds?.openedColor&&this.setOpenedColor(t.sunblinds.openedColor),void 0!==t.sunblinds?.closedColor&&this.setClosedColor(t.sunblinds.closedColor),void 0!==t.sunblinds?.slatColor&&this.setSlatColor(t.sunblinds.slatColor),void 0!==t.showHeatingCoolings&&this.setShowHeatingCoolings(t.showHeatingCoolings),void 0!==t.hcs?.roomTempAdjustRange&&this.setRoomTempAdjustRange(t.hcs.roomTempAdjustRange),void 0!==t.hcs?.unit&&this.setUnit(t.hcs.unit),void 0!==t.showWindows&&this.setShowWindows(t.showWindows),this}setName(e){let n=t.ValueConverter.toString(e);return null==n&&(n=this.getAttributeDefaultValueInternal("Name")),n==this.__attrHandler.name||null!=n&&"string"!=typeof n||(this.__attrHandler.name=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Name"}),this.__processName()),this}__processName(){this.__headerSideMenu&&this.__headerSideMenu.getControl(i.__headlineSideMenuName)?.textHandler.setText(this.__attrHandler.name),this.__roomStatus.getControl(i.__nameDisplayName)?.textHandler.setText(this.__attrHandler.name)}getName(){return this.__attrHandler.name}setControlUnits(e){let n=t.ValueConverter.toObject(e);return null==n&&(n=this.getAttributeDefaultValueInternal("ControlUnits")),tchmi_equal(n,this.__attrHandler.controlUnitOptions)||(this.__attrHandler.controlUnitOptions=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ControlUnits"}),this.__processControlUnits()),this}__processControlUnits(){if(null!=this.__attrHandler.lights?.baInterfaceSymbolNames&&null!=this.__attrHandler.sunblinds?.baInterfaceSymbolNames&&null!=this.__attrHandler.hcs?.baInterfaceSymbolNames&&null!=this.__attrHandler.windows?.baInterfaceSymbolNames)return new Promise((async(t,n)=>{let o=e.Helper.Object.clone(this.__ctrlCnt);if(this.__ctrlCnt={sunblind:0,light:0,hc:0,window:0},null==this.__attrHandler.controlUnitOptions){for(let t=0;t<this.__controlUnits.length;t++)this.__controlUnits[t].destroy();this.__controlUnits=[]}else{let t=[];for(let e=0;e<this.__attrHandler.controlUnitOptions.length;e++){const n=this.__attrHandler.controlUnitOptions[e];if(this.__currentlyAddedControlUnits.indexOf(n)>-1)return;this.__currentlyAddedControlUnits.push(n),t.push(this.__addControlUnit(n,e))}await Promise.all(t),this.__currentlyAddedControlUnits=[],this.__processShowControlUnits();for(let t in this.__ctrlCnt)if(o[t]>this.__ctrlCnt[t])for(let e=o[t]-1;e>=this.__ctrlCnt[t];e--){let n=this.childrenHandler.getChildren().get(this.__id+"-"+t+"-control-unit-"+e);if(n){n.destroy();let o=this.__controlUnits.findIndex((n=>n.getId()===this.__id+"-"+t+"-control-unit-"+e));this.__controlUnits.splice(o,1)}}this.onPriorityChanged()}tchmi_equal(o,this.__ctrlCnt)||(this.__destroySideMenu(),this.onResized()),this.__ctrlCnt.light>0&&!this.__roomStatus.getControl(i.__lightIconName)&&(this.__roomStatus.addControl({type:e.Components.ComponentType.Icon,name:i.__lightIconName,settings:{iconPath:e.Icons.RoomAutomation.Lamp2.path,iconHeight:90,iconHeightUnit:"%",iconWidth:90,iconWidthUnit:"%",cssClass:"fixed-size",hide:this.__attrHandler.showRoomName,order:1}}),this.onBrightnessChanged()),this.__updateControlHeight(),this.__sideMenu&&this.__processSideMenuHeader(),t()}))}getControlUnits(){return this.__attrHandler.controlUnitOptions}setPresence(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("Presence")),n==this.__attrHandler.presence||null!=n&&"boolean"!=typeof n||(this.__attrHandler.presence=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Presence"}),this.__processPresence()),this}__processPresence(){null==this.__attrHandler.presence?(this.__roomStatus.getControl(i.__presenceIconName)&&this.__roomStatus.removeControl(i.__presenceIconName),this.__sideMenu&&this.__roomStatusSideMenu?.getControl(i.__presenceIconName)&&this.__roomStatusSideMenu?.removeControl(i.__presenceIconName),this.__presenceLegendIconHandler.hide()):(this.__roomStatus.getControl(i.__presenceIconName)||this.__roomStatus.addControl({type:e.Components.ComponentType.Icon,name:i.__presenceIconName,settings:{iconPath:e.Icons.RoomAutomation.Presence.path,iconHeight:90,iconHeightUnit:"%",iconWidth:90,iconWidthUnit:"%",cssClass:"fixed-size",hide:this.__attrHandler.showRoomName,order:3}}),this.__sideMenu&&this.__roomStatusSideMenu&&!this.__roomStatusSideMenu.getControl(i.__presenceIconName)&&this.__roomStatusSideMenu?.addControl({type:e.Components.ComponentType.Icon,name:i.__presenceIconName,settings:{iconPath:e.Icons.RoomAutomation.Presence.path,iconHeight:100,iconHeightUnit:"%",iconWidth:100,iconWidthUnit:"%",cssClass:"fixed-size",order:3}}),this.__attrHandler.presence?(this.__roomStatus.getControl(i.__presenceIconName)?.iconHandler.setIconColor(e.Color.RGBAColor.DarkOrange),this.__roomStatusSideMenu?.getControl(i.__presenceIconName)?.iconHandler.setIconColor(e.Color.RGBAColor.DarkOrange)):(this.__roomStatus.getControl(i.__presenceIconName)?.iconHandler.setIconColor(e.Color.RGBAColor.White),this.__roomStatusSideMenu?.getControl(i.__presenceIconName)?.iconHandler.setIconColor(e.Color.RGBAColor.White)),this.__isAttached&&this.__presenceLegendIconHandler.show()),this.__processRoomStatus()}getPresence(){return this.__attrHandler.presence}setSwitchOffDelayActive(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("SwitchOffDelayActive")),n==this.__attrHandler.switchOffDelayActive||null!=n&&"boolean"!=typeof n||(this.__attrHandler.switchOffDelayActive=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SwitchOffDelayActive"}),this.__processSwitchOffDelayActive()),this}__processSwitchOffDelayActive(){null==this.__attrHandler.switchOffDelayActive?(this.__roomStatus.getControl(i.__switchOffDelayIconName)&&this.__roomStatus.removeControl(i.__switchOffDelayIconName),this.__sideMenu&&this.__roomStatusSideMenu?.getControl(i.__switchOffDelayIconName)&&this.__roomStatusSideMenu?.removeControl(i.__switchOffDelayIconName),this.__switchOffDelayLegendIconHandler.hide()):(this.__roomStatus.getControl(i.__switchOffDelayIconName)||this.__roomStatus.addControl({type:e.Components.ComponentType.Icon,name:i.__switchOffDelayIconName,settings:{iconPath:e.Icons.RoomAutomation.SwitchOffDelay.path,iconHeight:90,iconHeightUnit:"%",iconWidth:90,iconWidthUnit:"%",cssClass:"fixed-size",hide:this.__attrHandler.showRoomName,order:4}}),this.__sideMenu&&this.__roomStatusSideMenu&&!this.__roomStatusSideMenu.getControl(i.__switchOffDelayIconName)&&this.__roomStatusSideMenu?.addControl({type:e.Components.ComponentType.Icon,name:i.__switchOffDelayIconName,settings:{iconPath:e.Icons.RoomAutomation.SwitchOffDelay.path,iconHeight:100,iconHeightUnit:"%",iconWidth:100,iconWidthUnit:"%",cssClass:"fixed-size",order:4}}),this.__attrHandler.switchOffDelayActive?(this.__roomStatus.getControl(i.__switchOffDelayIconName)?.iconHandler.setIconColor(e.Color.RGBAColor.TcHmiGreen),this.__roomStatusSideMenu?.getControl(i.__switchOffDelayIconName)?.iconHandler.setIconColor(e.Color.RGBAColor.TcHmiGreen)):(this.__roomStatus.getControl(i.__switchOffDelayIconName)?.iconHandler.setIconColor(e.Color.RGBAColor.White),this.__roomStatusSideMenu?.getControl(i.__switchOffDelayIconName)?.iconHandler.setIconColor(e.Color.RGBAColor.White)),this.__isAttached&&this.__switchOffDelayLegendIconHandler.show()),this.__processRoomStatus()}getSwitchOffDelayActive(){return this.__attrHandler.switchOffDelayActive}setHideRoomStatus(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("HideRoomStatus")),n==this.__attrHandler.hideRoomStatus||null!=n&&"boolean"!=typeof n||(this.__attrHandler.hideRoomStatus=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HideRoomStatus"}),this.__processHideRoomStatus()),this}__processHideRoomStatus(){this.__attrHandler.hideRoomStatus?(this.__roomStatus.hide(),this.__roomStatusLightLegendIconHandler.hide()):(this.__roomStatus.show(),this.__roomStatusLightLegendIconHandler.show()),this.__updateControlHeight(),this.onResized()}getHideRoomStatus(){return this.__attrHandler.hideRoomStatus}setShowRoomName(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("ShowRoomName")),n==this.__attrHandler.showRoomName||null!=n&&"boolean"!=typeof n||(this.__attrHandler.showRoomName=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowRoomName"}),this.__processShowRoomName()),this}__processShowRoomName(){this.__attrHandler.showRoomName?(this.__roomStatus.getControl(i.__lightIconName)?.hide(),this.__roomStatus.getControl(i.__priorityIconName)?.hide(),this.__roomStatus.getControl(i.__presenceIconName)?.hide(),this.__roomStatus.getControl(i.__switchOffDelayIconName)?.hide(),null==this.__roomStatus.getControl(i.__nameDisplayName)&&this.__roomStatus.addControl({type:e.Components.ComponentType.Textblock,name:i.__nameDisplayName,settings:{textAttributes:{horizontalAlignment:"Center",text:this.__attrHandler.name,overflow:e.Components.TextHandler.Overflow.marquee},layout:{width:100,widthUnit:"%"}}}),this.__roomStatus.getControl(i.__nameDisplayName)?.show()):(this.__roomStatus.getControl(i.__lightIconName)?.show(),this.__roomStatus.getControl(i.__priorityIconName)?.show(),this.__roomStatus.getControl(i.__presenceIconName)?.show(),this.__roomStatus.getControl(i.__switchOffDelayIconName)?.show(),this.__roomStatus.getControl(i.__nameDisplayName)?.hide()),this.__updateControlHeight(),this.onResized()}getShowRoomName(){return this.__attrHandler.showRoomName}setShowLights(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("ShowLights")),n==this.__attrHandler.showLights||null!=n&&"boolean"!=typeof n||(this.__attrHandler.showLights=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowLights"}),this.__processShowControlUnits()),this}getShowLights(){return this.__attrHandler.showLights}setLightsBaInterfaceSymbolNames(n){let o=t.ValueConverter.toObject(n);if(null==o&&(o=this.getAttributeDefaultValueInternal("LightsBaInterfaceSymbolNames")),o===this.__attrHandler.lights?.baInterfaceSymbolNames)return this;if(null!=o){null==this.__attrHandler.lights&&(this.__attrHandler.lights={});let t=e.BaInterfaceHandler.convertToBaInterfaceSymbolNames(o);if(null!=this.__attrHandler.lights.baInterfaceSymbolNames)for(let e in t)this.__attrHandler.lights.baInterfaceSymbolNames[e]=t[e];else this.__attrHandler.lights.baInterfaceSymbolNames=t}return this.__processLightsBaInterfaceSymbolNames(),this.__processControlUnits(),this}__processLightsBaInterfaceSymbolNames(){null!=this.__attrHandler.lights?.baInterfaceSymbolNames&&(this.__controlUnits.forEach((t=>{t instanceof s.LightControl&&t.setBaInterfaceSymbolNames(this.__attrHandler.lights.baInterfaceSymbolNames)})),this.processBaObject())}getLightsBaInterfaceSymbolNames(){return this.__attrHandler.lights?.baInterfaceSymbolNames}setLightColor(n){let o=t.ValueConverter.toObject(n);return null==o&&(o=this.getAttributeDefaultValueInternal("LightColor")),null!=o&&!e.Color.isSolidColor(o)||void 0===o||o===this.__attrHandler.lights?.lightColor||(null!=o&&t.isSolidColor(o)&&(o=e.Color.RGBAColor.fromSolidColor(o)),null==o||o instanceof e.Color.RGBAColor||(o=new e.Color.RGBAColor(o)),null==this.__attrHandler.lights&&(this.__attrHandler.lights={}),this.__attrHandler.lights.lightColor=o,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"LightColor"}),this.__processLightColor()),this}__processLightColor(){this.__controlUnits.forEach((t=>{t instanceof s.LightControl&&t.setLightColor(this.__attrHandler.lights?.lightColor)})),this.onBrightnessChanged(),this.__updateControlUnitHeader(r.light)}getLightColor(){return this.__attrHandler.lights?.lightColor?.toSolidColor()}setShowSunblinds(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("ShowSunblinds")),n==this.__attrHandler.showSunblinds||null!=n&&"boolean"!=typeof n||(this.__attrHandler.showSunblinds=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowSunblinds"}),this.__processShowControlUnits()),this}getShowSunblinds(){return this.__attrHandler.showSunblinds}setUsePosition(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("UsePosition")),n===this.__attrHandler.sunblinds?.usePosition||(null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.usePosition=n,this.__processUsePosition(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"UsePosition"})),this}__processUsePosition(){this.__controlUnits.forEach((t=>{t instanceof s.SunblindControl&&t.setUsePosition(this.__attrHandler.sunblinds?.usePosition)}))}getUsePosition(){return this.__attrHandler.sunblinds?.usePosition}setUseAngle(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("UseAngle")),n===this.__attrHandler.sunblinds?.useAngle||(null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.useAngle=n,this.__processUseAngle(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"UseAngle"})),this}__processUseAngle(){this.__controlUnits.forEach((t=>{t instanceof s.SunblindControl&&t.setUseAngle(this.__attrHandler.sunblinds?.useAngle)}))}getUseAngle(){return this.__attrHandler.sunblinds?.useAngle}setAngleStep(e){let n=t.ValueConverter.toNumber(e);return null==n&&(n=this.getAttributeDefaultValueInternal("AngleStep")),n===this.__attrHandler.sunblinds?.angleStep||(null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.angleStep=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"AngleStep"}),this.__processAngleStep()),this}__processAngleStep(){this.__controlUnits.forEach((t=>{t instanceof s.SunblindControl&&t.setAngleStep(this.__attrHandler.sunblinds?.angleStep)}))}getAngleStep(){return this.__attrHandler.sunblinds?.angleStep}setSunblindsBaInterfaceSymbolNames(n){let o=t.ValueConverter.toObject(n);if(null==o&&(o=this.getAttributeDefaultValueInternal("SunblindsBaInterfaceSymbolNames")),o===this.__attrHandler.sunblinds?.baInterfaceSymbolNames)return this;if(null!=o){let t=this.__attrHandler.sunblinds?.baInterfaceSymbolNames;if(null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.baInterfaceSymbolNames=e.BaInterfaceHandler.convertToBaInterfaceSymbolNames(o),null!=t)for(let e in t)null==this.__attrHandler.sunblinds.baInterfaceSymbolNames[e]&&(this.__attrHandler.sunblinds.baInterfaceSymbolNames[e]=t[e])}return this.__processSunblindssBaInterfaceSymbolNames(),this.__processControlUnits(),this}__processSunblindssBaInterfaceSymbolNames(){null!=this.__attrHandler.sunblinds?.baInterfaceSymbolNames&&(this.__controlUnits.forEach((t=>{t instanceof s.SunblindControl&&t.setBaInterfaceSymbolNames(this.__attrHandler.sunblinds.baInterfaceSymbolNames)})),this.processBaObject())}getSunblindsBaInterfaceSymbolNames(){return this.__attrHandler.sunblinds?.baInterfaceSymbolNames}setOpenedColor(n){let o=t.ValueConverter.toObject(n);return null==o&&(o=this.getAttributeDefaultValueInternal("OpenedColor")),null!=o&&!e.Color.isSolidColor(o)||void 0===o||tchmi_equal(o,this.__attrHandler.sunblinds?.openedColor)||(null!=o&&t.isSolidColor(o)&&(o=e.Color.RGBAColor.fromSolidColor(o)),null==o||o instanceof e.Color.RGBAColor||(o=new e.Color.RGBAColor(o)),null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.openedColor=o,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"OpenedColor"}),this.__processOpenedColor()),this}__processOpenedColor(){this.__controlUnits.forEach((t=>{t instanceof s.SunblindControl&&t.setOpenedColor(this.__attrHandler.sunblinds?.openedColor)}))}getOpenedColor(){return this.__attrHandler.sunblinds?.openedColor?.toSolidColor()}setClosedColor(n){let o=t.ValueConverter.toObject(n);return null==o&&(o=this.getAttributeDefaultValueInternal("ClosedColor")),null!=o&&!e.Color.isSolidColor(o)||void 0===o||tchmi_equal(o,this.__attrHandler.sunblinds?.closedColor)||(null!=o&&t.isSolidColor(o)&&(o=e.Color.RGBAColor.fromSolidColor(o)),null==o||o instanceof e.Color.RGBAColor||(o=new e.Color.RGBAColor(o)),null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.closedColor=o,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ClosedColor"}),this.__processClosedColor()),this}__processClosedColor(){this.__controlUnits.forEach((t=>{t instanceof s.SunblindControl&&t.setClosedColor(this.__attrHandler.sunblinds?.closedColor)}))}getClosedColor(){return this.__attrHandler.sunblinds?.closedColor?.toSolidColor()}setSlatColor(n){let o=t.ValueConverter.toObject(n);return null==o&&(o=this.getAttributeDefaultValueInternal("SlatColor")),null!=o&&!e.Color.isSolidColor(o)||void 0===o||tchmi_equal(o,this.__attrHandler.sunblinds?.slatColor)||(null!=o&&t.isSolidColor(o)&&(o=e.Color.RGBAColor.fromSolidColor(o)),null==o||o instanceof e.Color.RGBAColor||(o=new e.Color.RGBAColor(o)),null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.slatColor=o,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SlatColor"}),this.__processSlatColor()),this}__processSlatColor(){this.__controlUnits.forEach((t=>{t instanceof s.SunblindControl&&t.setSlatColor(this.__attrHandler.sunblinds?.slatColor)}))}getSlatColor(){return this.__attrHandler.sunblinds?.slatColor?.toSolidColor()}setShowHeatingCoolings(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("ShowHeatingCoolings")),n==this.__attrHandler.showHeatingCoolings||null!=n&&"boolean"!=typeof n||(this.__attrHandler.showHeatingCoolings=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowHeatingCoolings"}),this.__processShowControlUnits()),this}getShowHeatingCoolings(){return this.__attrHandler.showHeatingCoolings}setRoomTempAdjustRange(e){let n=t.ValueConverter.toNumber(e);return null==n&&(n=this.getAttributeDefaultValueInternal("RoomTempAdjustRange")),n===this.__attrHandler.hcs?.roomTempAdjustRange||(null==n&&(n=3),null==this.__attrHandler.hcs&&(this.__attrHandler.hcs={}),this.__attrHandler.hcs.roomTempAdjustRange=n,this.__processRoomTempAdjustRange(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RoomTempAdjustRange"})),this}__processRoomTempAdjustRange(){this.__controlUnits.forEach((t=>{t instanceof s.HeatingCoolingControl&&t.setRoomTempAdjustRange(this.__attrHandler.hcs?.roomTempAdjustRange)}))}getRoomTempAdjustRange(){return this.__attrHandler.hcs?.roomTempAdjustRange}setUnit(e){let n=t.ValueConverter.toString(e);return null==n&&(n=this.getAttributeDefaultValueInternal("Unit")),n===this.__attrHandler.hcs?.unit||(null==this.__attrHandler.hcs&&(this.__attrHandler.hcs={}),this.__attrHandler.hcs.unit=n,this.__processUnit(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Unit"})),this}__processUnit(){this.__controlUnits.forEach((t=>{t instanceof s.HeatingCoolingControl&&t.setUnit(this.__attrHandler.hcs?.unit)}))}getUnit(){return this.__attrHandler.hcs?.unit}setHCsBaInterfaceSymbolNames(n){let o=t.ValueConverter.toObject(n);if(null==o&&(o=this.getAttributeDefaultValueInternal("HCsBaInterfaceSymbolNames")),o===this.__attrHandler.hcs?.baInterfaceSymbolNames)return this;if(null!=o){let t=this.__attrHandler.hcs?.baInterfaceSymbolNames;if(null==this.__attrHandler.hcs&&(this.__attrHandler.hcs={}),this.__attrHandler.hcs.baInterfaceSymbolNames=e.BaInterfaceHandler.convertToBaInterfaceSymbolNames(o),null!=t)for(let e in t)null==this.__attrHandler.hcs.baInterfaceSymbolNames[e]&&(this.__attrHandler.hcs.baInterfaceSymbolNames[e]=t[e])}return this.__processHCsBaInterfaceSymbolNames(),this.__processControlUnits(),this}__processHCsBaInterfaceSymbolNames(){null!=this.__attrHandler.hcs?.baInterfaceSymbolNames&&(this.__controlUnits.forEach((t=>{t instanceof s.HeatingCoolingControl&&t.setBaInterfaceSymbolNames(this.__attrHandler.hcs.baInterfaceSymbolNames)})),this.processBaObject())}getHCsBaInterfaceSymbolNames(){return this.__attrHandler.hcs?.baInterfaceSymbolNames}setShowWindows(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("ShowWindows")),n==this.__attrHandler.showWindows||null!=n&&"boolean"!=typeof n||(this.__attrHandler.showWindows=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowWindows"}),this.__processShowControlUnits()),this}getShowWindows(){return this.__attrHandler.showWindows}setWindowsBaInterfaceSymbolNames(n){let o=t.ValueConverter.toObject(n);if(null==o&&(o=this.getAttributeDefaultValueInternal("WindowsBaInterfaceSymbolNames")),o===this.__attrHandler.windows?.baInterfaceSymbolNames)return this;if(null!=o){let t=this.__attrHandler.windows?.baInterfaceSymbolNames;if(null==this.__attrHandler.windows&&(this.__attrHandler.windows={}),this.__attrHandler.windows.baInterfaceSymbolNames=e.BaInterfaceHandler.convertToBaInterfaceSymbolNames(o),null!=t)for(let e in t)null==this.__attrHandler.windows.baInterfaceSymbolNames[e]&&(this.__attrHandler.windows.baInterfaceSymbolNames[e]=t[e])}return this.__processWindowsBaInterfaceSymbolNames(),this.__processControlUnits(),this}__processWindowsBaInterfaceSymbolNames(){null!=this.__attrHandler.windows?.baInterfaceSymbolNames&&(this.__controlUnits.forEach((t=>{t instanceof s.WindowControl&&t.setBaInterfaceSymbolNames(this.__attrHandler.windows.baInterfaceSymbolNames)})),this.processBaObject())}getWindowsBaInterfaceSymbolNames(){return this.__attrHandler.windows?.baInterfaceSymbolNames}__processReadOnly(){super.__processReadOnly()}}let r;i.__headlineSideMenuName="side-menu-headline",i.__nameDisplayName="name-display",i.__lightIconName="light-icon",i.__priorityIconName="priority-icon",i.__resetManualButtonName="reset-manual-button",i.__presenceIconName="presence-icon",i.__switchOffDelayIconName="switch-off-delay-icon",i.__openBaObjectListButtonName="open-ba-object-list-button",i.__controlUnitHeaderSwitchName="switch",i.__controlUnitHeaderSliderName="slider",s.Control=i,function(t){let e;!function(t){t.onSideMenuOpened="onSideMenuOpened",t.onSideMenuClosed="onSideMenuClosed"}(e=t.ControlEvents||(t.ControlEvents={}))}(i=s.Control||(s.Control={})),s.DefaultBaObjectListDialogWidth=1e3,function(t){t[t.invalid=0]="invalid",t[t.light=1]="light",t[t.sunblind=2]="sunblind",t[t.hc=3]="hc",t[t.window=4]="window"}(r=s.ControlUnitType||(s.ControlUnitType={}))}(s=o.RoomControl||(o.RoomControl={}))}(n.RoomAutomation||(n.RoomAutomation={}))}(e.Controls||(e.Controls={}))}(t.BuildingAutomation||(t.BuildingAutomation={}))}(TcHmi||(TcHmi={})),TcHmi.Controls.registerEx("RoomControl","TcHmi.BuildingAutomation.Controls.RoomAutomation",TcHmi.BuildingAutomation.Controls.RoomAutomation.RoomControl.Control);