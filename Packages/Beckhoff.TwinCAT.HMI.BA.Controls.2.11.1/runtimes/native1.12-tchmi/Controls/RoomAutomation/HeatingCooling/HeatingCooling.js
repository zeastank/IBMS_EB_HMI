var TcHmi;!function(t){!function(e){!function(i){!function(o){class s extends i.System.BaseRoomControl{constructor(t,e,i){super(t,e,i),this.__tempAdjustFeedbackReady=[]}__previnit(){null==this.__baFc&&(this.__baFc=new s.Icon(this.__id+"-ba-fc",this)),super.__previnit(),this.__baFc.textHandler.setOverflow(e.Components.TextHandler.Overflow.marquee),this.__tempAdjustSlider=new s.TemperatureAdjustSlider(this.__id+"-temp-adjust-slider",this),this.__addControl(s.__controlContainerName,this.__tempAdjustSlider,1),this.baInterfaceHandler.baInterfaceDefinition=s.BaInterfaceDef,this.setBaInterfaceSymbolNames(s.BaInterfaceSymbolNames),void 0===this.__attrHandler.roomTempAdjustRange&&this.setRoomTempAdjustRange(3)}__init(){super.__init(),this.__updateDisplay()}__attach(){super.__attach(),this.__processIsControllable(!0),this.__destroyersToCallOnDetach.push(this.__tempAdjustSlider.eventHandler.register(s.TemperatureAdjustSlider.TimeAdjustSliderEvents.onUserInteractionFinished,((t,e,i)=>{this.writeRoomTempAdjustToPlc(i)}))),this.__destroyersToCallOnDetach.push(this.__tempAdjustSlider.eventHandler.register(s.TemperatureAdjustSlider.TimeAdjustSliderEvents.onShowDisplays,(()=>{this.__element.addClass("temp-adjust-slider-show-displays")}))),this.__destroyersToCallOnDetach.push(this.__tempAdjustSlider.eventHandler.register(s.TemperatureAdjustSlider.TimeAdjustSliderEvents.onHideDisplays,(()=>{this.__element.removeClass("temp-adjust-slider-show-displays")})))}__detach(){super.__detach()}destroy(){this.__keepAlive||(this.__tempAdjustSlider.destroy(),super.destroy())}__processChangedRoomTempAdjust(t){if(this.setRoomTempAdjust(t),null!=this.__attrHandler.roomTempAdjustFeedback&&this.__attrHandler.roomTempAdjust!=this.__attrHandler.roomTempAdjustFeedback){let t=()=>{this.__tempAdjustFeedbackReady.forEach((t=>t())),this.__tempAdjustFeedbackReady=[],this.setRoomTempAdjust(this.__attrHandler.roomTempAdjustFeedback)};this.__tempAdjustFeedbackReady.push(this.busyHandler.setBusy("Waiting for RoomTempAdjustFeedback",{cbOnTimeout:t,showIndicator:o.showBusyIndicator}))}}__updateDisplay(){this.__attributesInitialized&&(this.__attrHandler.showTemperatures?(this.__element.addClass("show-displays"),this.__baFc.textHandler.setText(this.getTemperatureText())):(this.__baFc.textHandler.setText(""),this.__element.removeClass("show-displays"),this.__baFc.textHandler.setText(null)))}static processBaObject(t,e,o){null==e&&(e=s.BaInterfaceSymbolNames),i.System.BaseRoomControl.processBaObject(t,e,o);let r=t.baObjectHandler;if(null!=r&&r.baObject?.checkParams(s.BaInterfaceDef,e,t,!0)){let t=r.baObject.tryGetBaVariable("roomTemp");null!=t&&r.watchBaVariable(t,(t=>{o.processRoomTemp(t)}));let e=r.baObject.tryGetBaVariable("roomTempAdjust");null!=e&&r.watchBaVariable(e,(t=>{o.processRoomTempAdjust(t),o.processRoomTempAdjustFeedback(t)}));let i=r.baObject.tryGetBaVariable("roomTempAdjustRange");null!=i&&r.watchBaVariable(i,(t=>{o.processRoomTempAdjustRange(t)}));let s=r.baObject.tryGetBaVariable("heatingSetpoint");null!=s&&r.watchBaVariable(s,(t=>{o.processHeatingSetpoint(t)}));let n=r.baObject.tryGetBaVariable("heatingActive");null!=n&&r.watchBaVariable(n,(t=>{o.processHeatingActive(t)}));let a=r.baObject.tryGetBaVariable("coolingSetpoint");null!=a&&r.watchBaVariable(a,(t=>{o.processCoolingSetpoint(t)}));let l=r.baObject.tryGetBaVariable("coolingActive");null!=l&&r.watchBaVariable(l,(t=>{o.processCoolingActive(t)}));let _=r.baObject.tryGetBaVariable("energyLevel");null!=_&&r.watchBaVariable(_,(t=>{o.processEnergyLevel(t)}))}}static writeRoomTempAdjustToPlc(t,i){if(null!=t)if(i instanceof e.BA.BaBasicObject){const o=i.tryGetBaVariable("roomTempAdjust");null!=o&&o.write(t,(t=>{e.Logger.checkServerResult(e.Logger.Severity.warn,t)}))}else i instanceof e.BaInterfaceHandler&&i.writeSubSymbol("roomTempAdjust",t).then((t=>{e.Logger.checkServerResult(e.Logger.Severity.warn,t)}))}writeRoomTempAdjustToPlc(t){1!=this.busyHandler.getIsBusy()&&null!=t&&(null==this.baInterfaceHandler.baInterfaceSymNames&&(this.baInterfaceHandler.baInterfaceSymNames=s.BaInterfaceSymbolNames),this.baObjectHandler.baObject?.checkParams(s.BaInterfaceDef,this.baInterfaceHandler.baInterfaceSymNames)&&s.writeRoomTempAdjustToPlc(t,this.baObjectHandler.baObject),null!=this.baInterfaceHandler.getBaInterfaceSym()&&s.writeRoomTempAdjustToPlc(t,this.baInterfaceHandler),this.__processChangedRoomTempAdjust(t))}static getTemperatureText(t,i){if(e.Server.BaSite.UserManagement.checkAccess(e.BA.Role.eAdvanced)){const e=" &#x279E ",o=" "+t.unit;let r=null!=t.roomTemp?t.roomTemp.toFixed(1):"?";return r+=o,i===s.CurrentSetpoint.heating?r=r+e+(null!=t.heatingSetpoint?t.heatingSetpoint.toFixed(1):"?")+o:i===s.CurrentSetpoint.cooling&&(r=r+e+(null!=t.coolingSetpoint?t.coolingSetpoint.toFixed(1):"?")+o),r}return null!=t.roomTempAdjust?t.roomTempAdjust.toFixed(1)+" °K":"? °K"}getTemperatureText(){return s.getTemperatureText(this.__attrHandler,this.__baFc.currentSetpoint)}getIsLocked(){return i.System.BaseRoomControl.getIsLocked(this.__attrHandler)}getPriorityIcon(t){return null}hasManualPriority(){return!1}setBaObject(t){return this.baObjectHandler.setBaObject(t),this}getBaObject(){return this.baObjectHandler.baObject}setAttributes(t){return super.setAttributes(t),void 0!==t.roomTemp&&this.setRoomTemp(t.roomTemp),void 0!==t.roomTempAdjust&&this.setRoomTempAdjust(t.roomTempAdjust),void 0!==t.roomTempAdjustFeedback&&this.setRoomTempAdjustFeedback(t.roomTempAdjustFeedback),void 0!==t.roomTempAdjustRange&&this.setRoomTempAdjustRange(t.roomTempAdjustRange),void 0!==t.heatingSetpoint&&this.setHeatingSetpoint(t.heatingSetpoint),void 0!==t.coolingSetpoint&&this.setCoolingSetpoint(t.coolingSetpoint),void 0!==t.heatingActive&&this.setHeatingActive(t.heatingActive),void 0!==t.coolingActive&&this.setCoolingActive(t.coolingActive),void 0!==t.energyLevel&&this.setEnergyLevel(t.energyLevel),void 0!==t.showTemperatures&&this.setShowTemperatures(t.showTemperatures),void 0!==t.unit&&this.setUnit(t.unit),this}getAttributes(){return this.__attrHandler}setBaInterface(t){return super.setBaInterface(t),this.baInterfaceHandler.setBaInterfaceSym(t,(()=>{s.processBaInterface(this,{processError:t=>this.setError(t),processPriority:t=>this.setPriority(t),processRoomTemp:t=>this.setRoomTemp(t),processRoomTempAdjust:t=>this.setRoomTempAdjust(t),processRoomTempAdjustFeedback:t=>this.setRoomTempAdjustFeedback(t),processRoomTempAdjustReadOnly:t=>{this.__tempAdjustSlider.setReadOnly(t)},processRoomTempAdjustRange:t=>this.setRoomTempAdjustRange(t),processHeatingSetpoint:t=>this.setHeatingSetpoint(t),processHeatingActive:t=>this.setHeatingActive(t),processCoolingSetpoint:t=>this.setCoolingSetpoint(t),processCoolingActive:t=>this.setCoolingActive(t),processEnergyLevel:t=>this.setEnergyLevel(t)})})),this}setRoomTemp(e){let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("RoomTemp")),i===this.__attrHandler.roomTemp||(this.__attrHandler.roomTemp=i,this.__processRoomTemp(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RoomTemp"})),this}__processRoomTemp(){this.__updateDisplay(),this.__tempAdjustSlider.setRoomTemp(this.__attrHandler.roomTemp)}getRoomTemp(){return this.__attrHandler.roomTemp}setRoomTempAdjust(e){let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("RoomTempAdjust")),i===this.__attrHandler.roomTempAdjust||(this.__attrHandler.roomTempAdjust=i,this.__processRoomTempAdjust(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RoomTempAdjust"}),t.EventProvider.raise(this.__id+".onRoomTempAdjustChanged")),this}__processRoomTempAdjust(){this.__tempAdjustSlider.setRoomTempAdjust(this.__attrHandler.roomTempAdjust)}getTemperatureAdjust(){return this.__attrHandler.roomTempAdjust}setRoomTempAdjustFeedback(e){let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("RoomTempAdjustFeedback")),i===this.__attrHandler.roomTempAdjustFeedback||(this.__attrHandler.roomTempAdjustFeedback=i,null!=this.__attrHandler.roomTempAdjustFeedback&&(this.__processRoomTempAdjustFeedback(),this.__tempAdjustFeedbackReady.forEach((t=>t())),this.__tempAdjustFeedbackReady=[]),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RoomTempAdjustFeedback"})),this}__processRoomTempAdjustFeedback(){this.__tempAdjustSlider.setRoomTempAdjust(this.__attrHandler.roomTempAdjustFeedback)}getRoomTempAdjustFeedback(){return this.__attrHandler.roomTempAdjustFeedback}setRoomTempAdjustRange(e){let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("RoomTempAdjustRange")),i===this.__attrHandler.roomTempAdjustRange||(null==i&&(i=3),this.__attrHandler.roomTempAdjustRange=i,this.__processRoomTempAdjustRange(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RoomTempAdjustRange"})),this}__processRoomTempAdjustRange(){this.__tempAdjustSlider.setRoomTempAdjustRange(this.__attrHandler.roomTempAdjustRange)}getRoomTempAdjustRange(){return this.__attrHandler.roomTempAdjustRange}setHeatingSetpoint(e){let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("HeatingSetpoint")),i===this.__attrHandler.heatingSetpoint||(this.__attrHandler.heatingSetpoint=i,this.__processHeatingSetpoint(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeatingSetpoint"})),this}__processHeatingSetpoint(){this.__updateDisplay(),this.__tempAdjustSlider.setHeatingSetpoint(this.__attrHandler.heatingSetpoint)}getHeatingSetpoint(){return this.__attrHandler.heatingSetpoint}setCoolingSetpoint(e){let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("CoolingSetpoint")),i===this.__attrHandler.coolingSetpoint||(this.__attrHandler.coolingSetpoint=i,this.__processCoolingSetpoint(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"CoolingSetpoint"})),this}__processCoolingSetpoint(){this.__updateDisplay(),this.__tempAdjustSlider.setCoolingSetpoint(this.__attrHandler.coolingSetpoint)}getCoolingSetpoint(){return this.__attrHandler.coolingSetpoint}setHeatingActive(e){let i;return i="number"==typeof e?t.ValueConverter.toNumber(e):t.ValueConverter.toBoolean(e),null==i&&(i=this.getAttributeDefaultValueInternal("HeatingActive")),i===this.__attrHandler.heatingActive||(this.__attrHandler.heatingActive=i,this.__baFc.setHeatingActive("boolean"==typeof i?i:null!=i?i>0:i),this.__processHeatingActive(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeatingActive"})),this}__processHeatingActive(){this.__updateDisplay(),this.__tempAdjustSlider.setHeatingActive(this.__attrHandler.heatingActive)}getHeatingActive(){return this.__attrHandler.heatingActive}setCoolingActive(e){let i;return i="number"==typeof e?t.ValueConverter.toNumber(e):t.ValueConverter.toBoolean(e),null==i&&(i=this.getAttributeDefaultValueInternal("CoolingActive")),i===this.__attrHandler.coolingActive||(this.__attrHandler.coolingActive=i,this.__baFc.setCoolingActive("boolean"==typeof i?i:null!=i?i>0:i),this.__processCoolingActive(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"CoolingActive"})),this}__processCoolingActive(){this.__updateDisplay(),this.__tempAdjustSlider.setCoolingActive(this.__attrHandler.coolingActive)}getCoolingActive(){return this.__attrHandler.coolingActive}setShowTemperatures(e){let i=t.ValueConverter.toBoolean(e);return null==i&&(i=this.getAttributeDefaultValueInternal("ShowTemperatures")),i===this.__attrHandler.showTemperatures||(this.__attrHandler.showTemperatures=i,this.__processShowTemperatures(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowTemperatures"})),this}__processShowTemperatures(){this.__updateDisplay()}getShowTemperatures(){return this.__attrHandler.showTemperatures}setUnit(e){let i=t.ValueConverter.toString(e);return null==i&&(i=this.getAttributeDefaultValueInternal("Unit")),i===this.__attrHandler.unit||(this.__attrHandler.unit=i,this.__processUnit(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Unit"})),this}__processUnit(){this.__updateDisplay(),this.__tempAdjustSlider.setUnit(this.__attrHandler.unit)}getUnit(){return this.__attrHandler.unit}setEnergyLevel(e){let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("EnergyLevel")),i===this.__attrHandler.unit||(this.__attrHandler.energyLevel=i,this.__processEnergyLevel(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"EnergyLevel"})),this}__processEnergyLevel(){this.__attrHandler.energyLevel!=s.EnergyLevel.comfort?this.__tempAdjustSlider.setReadOnly(!0):this.__tempAdjustSlider.setReadOnly(!1)}getEnergyLevel(){return this.__attrHandler.energyLevel}processBaObject(){super.processBaObject(),s.processBaObject(this,this.baInterfaceHandler.baInterfaceSymNames,{processError:t=>this.setError(t),processPriority:t=>this.setPriority(t),processRoomTemp:t=>this.setRoomTemp(t),processRoomTempAdjust:t=>this.setRoomTempAdjust(t),processRoomTempAdjustFeedback:t=>this.setRoomTempAdjustFeedback(t),processRoomTempAdjustReadOnly:t=>{this.__tempAdjustSlider.setReadOnly(t)},processRoomTempAdjustRange:t=>this.setRoomTempAdjustRange(t),processHeatingSetpoint:t=>this.setHeatingSetpoint(t),processHeatingActive:t=>this.setHeatingActive(t),processCoolingSetpoint:t=>this.setCoolingSetpoint(t),processCoolingActive:t=>this.setCoolingActive(t),processEnergyLevel:t=>this.setEnergyLevel(t)})}static processBaInterface(t,e){i.System.BaseRoomControl.processBaInterface(t,e),t.baInterfaceHandler.watchSubSymbol("roomTemp",(t=>{e.processRoomTemp(t)})),t.baInterfaceHandler.watchSubSymbol("roomTempAdjust",(t=>{e.processRoomTempAdjust(t),e.processRoomTempAdjustFeedback(t)})),e.processRoomTempAdjustReadOnly(!1),t.baInterfaceHandler.hasSubSymbol("roomTempAdjustRange")&&t.baInterfaceHandler.watchSubSymbol("roomTempAdjustRange",(t=>{e.processRoomTempAdjustRange(t)})),t.baInterfaceHandler.watchSubSymbol("heatingSetpoint",(t=>{e.processHeatingSetpoint(t)})),t.baInterfaceHandler.watchSubSymbol("heatingActive",(t=>{e.processHeatingActive(t)})),t.baInterfaceHandler.watchSubSymbol("coolingSetpoint",(t=>{e.processCoolingSetpoint(t)})),t.baInterfaceHandler.watchSubSymbol("coolingActive",(t=>{e.processCoolingActive(t)})),t.baInterfaceHandler.hasSubSymbol("energyLevel")&&t.baInterfaceHandler.watchSubSymbol("energyLevel",(t=>{e.processEnergyLevel(t)}))}}s.__controlContainerName="setting",o.HeatingCooling=s,function(t){let o,s;!function(t){t[t.invalid=0]="invalid",t[t.heating=1]="heating",t[t.cooling=2]="cooling"}(o=t.CurrentSetpoint||(t.CurrentSetpoint={})),function(t){t[t.invalid=0]="invalid",t[t.protection=1]="protection",t[t.economy=2]="economy",t[t.preComfort=3]="preComfort",t[t.comfort=4]="comfort"}(s=t.EnergyLevel||(t.EnergyLevel={})),t.BaInterfaceDef={...i.System.BaseRoomControl.BaInterfaceDef,roomTemp:{type:"number"},roomTempAdjust:{type:"number"},roomTempAdjustRange:{type:"number",optional:!0},heatingSetpoint:{type:"number"},heatingActive:{type:["boolean","number"]},coolingSetpoint:{type:"number"},coolingActive:{type:["boolean","number"]},energyLevel:{type:"integer",optional:!0}},t.BaInterfaceSymbolNames={...i.System.BaseRoomControl.BaInterfaceSymbolNames,roomTemp:{symbolName:"fRmT_Out"},roomTempAdjust:{symbolName:"fRmTAdj_In"},roomTempAdjustRange:{symbolName:"fRmTAdjLimit_Out"},heatingSetpoint:{symbolName:"fSPHtg_Out"},heatingActive:{symbolName:"fCtrlValHtg_Out"},coolingSetpoint:{symbolName:"fSPCol_Out"},coolingActive:{symbolName:"fCtrlValCol_Out"},energyLevel:{symbolName:"eActualEnergyLevel_Out"}};class r extends e.Components.Button{constructor(i,o){super(i,o),this.currentSetpoint=t.CurrentSetpoint.invalid,this.__element.addClass("hc-control-icon"),this.iconHandler.setIconHeight(90,"%"),this.iconHandler.setIconWidth(90,"%"),this.iconHandler.setIcon(e.Icons.RoomAutomation.Temperature.path,!0),this.__legendIconHandler.icon=e.Icons.convertIIconDataToIIconAttributes(e.Icons.RoomAutomation.Temperature)}__attach(){this.__isAttached||(super.__attach(),this.__legendIconHandler.show())}__detach(){this.__isAttached&&super.__detach()}destroy(){super.destroy()}__updateElements(){null==this.__attrHandler.coolingActive&&null==this.__attrHandler.heatingActive||(this.__element.removeClass("cooling-active"),this.__element.removeClass("heating-active"),1==this.__attrHandler.heatingActive?(this.iconHandler.setIcon(e.Icons.RoomAutomation.Heating.path,!0).setIconColor(e.Color.RGBAColor.Red),this.__legendIconHandler.icon=e.Icons.convertIIconDataToIIconAttributes(e.Icons.RoomAutomation.Heating),this.currentSetpoint=t.CurrentSetpoint.heating):1==this.__attrHandler.coolingActive?(this.iconHandler.setIcon(e.Icons.RoomAutomation.Cooling.path,!0).setIconColor(e.Color.RGBAColor.Blue),this.__legendIconHandler.icon=e.Icons.convertIIconDataToIIconAttributes(e.Icons.RoomAutomation.Cooling),this.currentSetpoint=t.CurrentSetpoint.cooling):(this.iconHandler.setIcon(e.Icons.RoomAutomation.Temperature.path,!0).setIconColor(e.Color.RGBAColor.White),this.__legendIconHandler.icon=e.Icons.convertIIconDataToIIconAttributes(e.Icons.RoomAutomation.Temperature),this.currentSetpoint=t.CurrentSetpoint.invalid),this.__isAttached&&this.__legendIconHandler.show())}setAttributes(t){return super.setAttributes(t),void 0!==t.heatingActive&&this.setHeatingActive(t.heatingActive),void 0!==t.coolingActive&&this.setCoolingActive(t.coolingActive),this}getAttributes(){return this.__attrHandler.getRef()}setHeatingActive(t){return this.__attrHandler.checkAttribute(t,"heatingActive",{validator:"boolean"})?(this.__attrHandler.heatingActive=t,this.__processHeatingActive(),this):this}__processHeatingActive(){this.__updateElements()}getHeatingActive(){return this.__attrHandler.heatingActive}setCoolingActive(t){return this.__attrHandler.checkAttribute(t,"coolingActive",{validator:"boolean"})?(this.__attrHandler.coolingActive=t,this.__processCoolingActive(),this):this}__processCoolingActive(){this.__updateElements()}getCoolingActive(){return this.__attrHandler.coolingActive}__processReadOnly(){super.__processReadOnly(),!0===this.__attrHandler.readOnly?this.__element.removeClass("button"):this.__element.addClass("button")}__updateLegendIcon(){}}t.Icon=r;class n extends e.Components.Base{constructor(e,i){super(e,i),this.__isDragging=!1,this.__isMouseover=!1,this.__originalPosInBtn=0,this.__internalCoolingSetpoint=0,this.__internalHeatingSetpoint=0,this.__offset=null,this.__mouseoverHandler=t=>{this.__onMouseoverHandler()},this.__pointerdownHandler=t=>{this.__onZonePointerDown(t)},this.__element.addClass("temp-adjust-slider"),this.__roomTempAdjust=0,this.__heatingZoneDisplay=$("<div>").addClass("zone-display heating"),this.__neutralZoneDisplay=$("<div>").addClass("zone-display neutral"),this.__tempAdjustDisplay=$("<span>").addClass("temp-adjust-display"),this.__neutralZoneDisplay.append(this.__tempAdjustDisplay),this.__coolingZoneDisplay=$("<div>").addClass("zone-display cooling"),this.__miniumTempDisplay=$("<div>").addClass("temp-display minimum-display").text(t.TemperatureAdjustSlider.MinimumRoomTemperature.toFixed(1)+" °C"),this.__maxiumTempDisplay=$("<div>").addClass("temp-display maximum-display").text(t.TemperatureAdjustSlider.MaximumRoomTemperature.toFixed(1)+" °C"),this.__tempCursor=$('<div>\n\t\t\t\t\t<svg version="1.1"\n\t\t\t\t\t   width="20" height="100"\n\t\t\t\t\t   xmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\t   viewBox="0 0 20 100"\n\t\t\t\t\t   style="\n\t\t\t\t\t\t  stroke: var(--tchmi-ba-temp-adjust-slider-cursor-color, black);\n\t\t\t\t\t\t  fill: transparent;\n\t\t\t\t\t\t  stroke-linecap: round;\n\t\t\t\t\t\t  stroke-linejoin: round;\n\t\t\t\t\t\t  stroke-width: var(--tchmi-ba-temp-adjust-cursor-weight, 10px);\n\t\t\t\t\t   ">\n\t\t\t\t\t   <g>\n\t\t\t\t\t\t  <path\n\t\t\t\t\t\t\t d="M 4 4 L 10 10 L 16 4 H 4 M 10 10 V 90 L 4 96 M 10 90 L 16 96 H 4" />\n\t\t\t\t\t   </g>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>').addClass("temp-cursor"),this.__tempCursorDisplay=$("<div>").addClass("temp-display temp-cursor-display"),this.__tempCursor.append(this.__tempCursorDisplay),this.__element.append(this.__neutralZoneDisplay,this.__heatingZoneDisplay,this.__coolingZoneDisplay,this.__tempCursor,this.__miniumTempDisplay,this.__maxiumTempDisplay)}__attach(){this.__isAttached||(this.__element.on("mouseover",this.__mouseoverHandler),this.__heatingZoneDisplay.on("pointerdown",this.__pointerdownHandler),this.__neutralZoneDisplay.on("pointerdown",this.__pointerdownHandler),this.__coolingZoneDisplay.on("pointerdown",this.__pointerdownHandler),this.__tempCursor.on("pointerdown",this.__pointerdownHandler),super.__attach())}__detach(){this.__isAttached&&(this.__element.off("mouseover",this.__mouseoverHandler),this.__heatingZoneDisplay.off("pointerdown",this.__pointerdownHandler),this.__neutralZoneDisplay.off("pointerdown",this.__pointerdownHandler),this.__coolingZoneDisplay.off("pointerdown",this.__pointerdownHandler),this.__tempCursor.off("pointerdown",this.__pointerdownHandler),super.__detach())}destroy(){super.destroy()}__onMouseoverHandler(){this.__isMouseover=!0,this.showDisplays();const t=()=>{this.__isMouseover=!1,this.__element.off("mouseout",t),this.hideDisplays()};this.__element.on("mouseout",t)}__onZonePointerDown(t){this.__attrHandler.readOnly||t.button===e.MouseButtons.left&&($(t.currentTarget).hasClass("neutral")||$(t.currentTarget).hasClass("temp-cursor"))&&this.__onNeutralZonePointerDown(t)}__onNeutralZonePointerDown(t){const e=t=>{this.__isDragging=!1,$("body").off("pointerup",e),$("body").off("mousemove touchmove",i),this.__roomTempAdjust!=this.__attrHandler.roomTempAdjust&&(this.setRoomTempAdjust(this.__roomTempAdjust),this.eventHandler.raise(n.TimeAdjustSliderEvents.onUserInteractionFinished,this.__roomTempAdjust)),this.__internalHeatingSetpoint=null!=this.__attrHandler.heatingSetpoint?this.__attrHandler.heatingSetpoint:0,this.__internalCoolingSetpoint=null!=this.__attrHandler.coolingSetpoint?this.__attrHandler.coolingSetpoint:0,this.hideDisplays()},i=t=>{this.__isDragging=!0,this.__onNeutralZoneMoved(t)};$("body").on("pointerup",e),this.__offset=this.__element.outerWidth()/(n.MaximumRoomTemperature-n.MinimumRoomTemperature),this.__originalPosInBtn=t.pageX-this.__neutralZoneDisplay.offset().left,$("body").on("mousemove touchmove",i)}__onNeutralZoneMoved(t){let i=t.currentTarget;if(null==i)return;let o=0;if("mousemove"===t.type?o=t.pageX:"touchmove"===t.type&&(o=t.touches[0].pageX),null==this.__offset||null==this.__attrHandler.coolingSetpoint||null==this.__attrHandler.heatingSetpoint||null==this.__attrHandler.roomTempAdjustRange||null==this.__attrHandler.roomTempAdjust)return;let s=o-this.__originalPosInBtn-this.__element.offset().left,r=n.MinimumRoomTemperature+s/this.__offset,a=Number(e.Helper.Number.snapToPeriode(r-this.__attrHandler.heatingSetpoint,n.RoomTemperatureAdjustStep).toFixed(1)),l=a+this.__attrHandler.roomTempAdjust,_=0;l<-this.__attrHandler.roomTempAdjustRange&&(_=l+this.__attrHandler.roomTempAdjustRange,l=-this.__attrHandler.roomTempAdjustRange),l>this.__attrHandler.roomTempAdjustRange&&(_=l-this.__attrHandler.roomTempAdjustRange,l=this.__attrHandler.roomTempAdjustRange),a-=_;let d=this.__attrHandler.heatingSetpoint+a,m=this.__attrHandler.coolingSetpoint+a;d<n.MinimumRoomTemperature||m>n.MaximumRoomTemperature||l!=this.__roomTempAdjust&&(this.__roomTempAdjust=l,this.__internalHeatingSetpoint=d,this.__internalCoolingSetpoint=m,this.__updateZones(),this.logger.debug(`TempAdj: ${l} | Heat SP: ${this.__internalHeatingSetpoint} °C | Cool SP: ${this.__internalCoolingSetpoint} °C`))}showDisplays(){null!=this.__attrHandler.roomTemp&&e.Server.BaSite.UserManagement.checkAccess(n.DisplayRoomTemperatureRole)&&(this.__miniumTempDisplay.text(t.TemperatureAdjustSlider.MinimumRoomTemperature.toFixed(1)+" "+this.__attrHandler.unit),this.__maxiumTempDisplay.text(t.TemperatureAdjustSlider.MaximumRoomTemperature.toFixed(1)+" "+this.__attrHandler.unit),this.__tempCursorDisplay.text(this.__attrHandler.roomTemp.toFixed(1)+" "+this.__attrHandler.unit),this.__element.addClass("show-displays"),!1===this.getReadOnly()&&e.Server.BaSite.UserManagement.checkAccess(n.DisplayRoomTemperatureAdjustRole)&&this.__tempAdjustDisplay.addClass("show-temperature-adjust"),e.Server.BaSite.UserManagement.checkAccess(n.DisplayRoomTemperatureLimitsRole)&&this.__element.addClass("show-room-temperature-limits"),this.eventHandler.raise(n.TimeAdjustSliderEvents.onShowDisplays))}hideDisplays(){this.__isMouseover||this.__isDragging||(this.__element.removeClass("show-displays show-room-temperature-limits"),this.__tempAdjustDisplay.removeClass("show-temperature-adjust"),this.eventHandler.raise(n.TimeAdjustSliderEvents.onHideDisplays))}__updateZones(){if(null!=this.__attrHandler.coolingSetpoint&&null!=this.__attrHandler.heatingSetpoint){let t=!1;if(this.__attrHandler.coolingSetpoint===this.__attrHandler.heatingSetpoint?(t=!0,this.logger.debug("Heating and cooling setpoint are equal! This can not be processed!")):this.__attrHandler.coolingSetpoint<this.__attrHandler.heatingSetpoint?(t=!0,this.logger.debug("Cooling setpoint is lower than heating setpoint! This can not be processed!")):this.__attrHandler.heatingSetpoint>this.__attrHandler.coolingSetpoint&&(t=!0,this.logger.debug("Heating setpoint is higher than cooling setpoint! This can not be processed!")),t)return this.__coolingZoneDisplay.css("--tchmi-ba-temp-adjust-slider-cooling-zone-display-width","0%"),void this.__heatingZoneDisplay.css("--tchmi-ba-temp-adjust-slider-heating-zone-display-width","0%")}if(null==this.__attrHandler.coolingSetpoint)this.__coolingZoneDisplay.css("--tchmi-ba-temp-adjust-slider-cooling-zone-display-width","33.33%");else{let i=100-e.Helper.Number.toPercentage(this.__internalCoolingSetpoint,t.TemperatureAdjustSlider.MinimumRoomTemperature,t.TemperatureAdjustSlider.MaximumRoomTemperature);i<0&&(i=0),this.__coolingZoneDisplay.css("--tchmi-ba-temp-adjust-slider-cooling-zone-display-width",i+"%")}if(null==this.__attrHandler.heatingSetpoint)this.__heatingZoneDisplay.css("--tchmi-ba-temp-adjust-slider-heating-zone-display-width","33.33%");else{let i=e.Helper.Number.toPercentage(this.__internalHeatingSetpoint,t.TemperatureAdjustSlider.MinimumRoomTemperature,t.TemperatureAdjustSlider.MaximumRoomTemperature);i<0&&(i=0),this.__heatingZoneDisplay.css("--tchmi-ba-temp-adjust-slider-heating-zone-display-width",i+"%")}this.__tempAdjustDisplay.text(this.__roomTempAdjust+" K")}setAttributes(t){return super.setAttributes(t),void 0!==t.roomTemp&&this.setRoomTemp(t.roomTemp),void 0!==t.roomTempAdjust&&this.setRoomTempAdjust(t.roomTempAdjust),void 0!==t.roomTempAdjustRange&&this.setRoomTempAdjustRange(t.roomTempAdjustRange),void 0!==t.heatingSetpoint&&this.setHeatingSetpoint(t.heatingSetpoint),void 0!==t.heatingActive&&this.setHeatingActive(t.heatingActive),void 0!==t.coolingSetpoint&&this.setCoolingSetpoint(t.coolingSetpoint),void 0!==t.coolingActive&&this.setCoolingActive(t.coolingActive),void 0!==t.unit&&this.setUnit(t.unit),this}getAttributes(){return this.__attrHandler.getRef()}setRoomTemp(t){return this.__attrHandler.checkAttribute(t,"roomTemp",{validator:"number"})?(this.__attrHandler.roomTemp=t,this.__processRoomTemp(),this):this}__processRoomTemp(){if(null==this.__attrHandler.roomTemp)this.__tempCursorDisplay.text("N/A"),this.__tempCursor.attr("left","");else{let i=this.__attrHandler.roomTemp;this.__attrHandler.roomTemp<t.TemperatureAdjustSlider.MinimumRoomTemperature?i=t.TemperatureAdjustSlider.MinimumRoomTemperature:this.__attrHandler.roomTemp>t.TemperatureAdjustSlider.MaximumRoomTemperature&&(i=t.TemperatureAdjustSlider.MaximumRoomTemperature);let o=e.Helper.Number.toPercentage(i,t.TemperatureAdjustSlider.MinimumRoomTemperature,t.TemperatureAdjustSlider.MaximumRoomTemperature);this.__tempCursor.css("left",o+"%")}}getRoomTemp(){return this.__attrHandler.roomTemp}setRoomTempAdjust(t){return this.__attrHandler.checkAttribute(t,"roomTempAdjust",{validator:"number",skipEqualityCheck:!0})?(this.__attrHandler.roomTempAdjust=t,this.__processRoomTempAdjust(),this):this}__processRoomTempAdjust(){null!=this.__attrHandler.roomTempAdjust&&(this.__roomTempAdjust=this.__attrHandler.roomTempAdjust,this.__updateZones())}getRoomTempAdjust(){return this.__attrHandler.roomTempAdjust}setRoomTempAdjustRange(t){return this.__attrHandler.checkAttribute(t,"roomTempAdjustRange",{validator:"number"})?(null==t&&(t=3),this.__attrHandler.roomTempAdjustRange=t,this):this}getRoomTempAdjustRange(){return this.__attrHandler.roomTempAdjustRange}setHeatingSetpoint(t){return this.__attrHandler.checkAttribute(t,"heatingSetpoint",{validator:"number"})?(this.__attrHandler.heatingSetpoint=t,null!=t&&(this.__internalHeatingSetpoint=t),this.__processHeatingSetpoint(),this):this}__processHeatingSetpoint(){this.__updateZones()}getHeatingSetpoint(){return this.__attrHandler.heatingSetpoint}setHeatingActive(t){return this.__attrHandler.checkAttribute(t,"heatingActive",{validator:["boolean","number"]})?(this.__attrHandler.heatingActive=t,this.__processHeatingActive(),this):this}__processHeatingActive(){this.__attrHandler&&(null!=this.__attrHandler.heatingActive&&e.Server.BaSite.UserManagement.checkAccess(n.DisplayControllerOutputRole)?"number"==typeof this.__attrHandler.heatingActive?this.__heatingZoneDisplay.text(" "+this.__attrHandler.heatingActive.toFixed(0)+" %"):this.__heatingZoneDisplay.text(" "+(this.__attrHandler.heatingActive?"On":"Off")):this.__heatingZoneDisplay.text(""),this.__attrHandler.heatingActive?this.__heatingZoneDisplay.removeClass("is-inactive"):this.__heatingZoneDisplay.addClass("is-inactive"))}getHeatingActive(){return this.__attrHandler.heatingActive}setCoolingSetpoint(t){return this.__attrHandler.checkAttribute(t,"coolingSetpoint",{validator:"number"})?(this.__attrHandler.coolingSetpoint=t,null!=t&&(this.__internalCoolingSetpoint=t),this.__processCoolingSetpoint(),this):this}__processCoolingSetpoint(){this.__updateZones()}getCoolingSetpoint(){return this.__attrHandler.coolingSetpoint}setCoolingActive(t){return this.__attrHandler.checkAttribute(t,"coolingActive",{validator:["boolean","number"]})?(this.__attrHandler.coolingActive=t,this.__processCoolingActive(),this):this}__processCoolingActive(){this.__attrHandler&&(null!=this.__attrHandler.coolingActive&&e.Server.BaSite.UserManagement.checkAccess(n.DisplayControllerOutputRole)?"number"==typeof this.__attrHandler.coolingActive?this.__coolingZoneDisplay.text(this.__attrHandler.coolingActive.toFixed(0)+" % "):this.__coolingZoneDisplay.text((this.__attrHandler.coolingActive?"On":"Off ")+" "):this.__coolingZoneDisplay.text(""),this.__attrHandler.coolingActive?this.__coolingZoneDisplay.removeClass("is-inactive"):this.__coolingZoneDisplay.addClass("is-inactive"))}getCoolingActive(){return this.__attrHandler.coolingActive}setUnit(t){return this.__attrHandler.checkAttribute(t,"unit",{validator:"string"})?(null==t&&(t="°C"),this.__attrHandler.unit=t,this):this}getUnit(){return this.__attrHandler.unit}__processReadOnly(){e.Server.BaSite.UserManagement.checkAccess(n.EditLevel)||(this.__attrHandler.readOnly=!0),super.__processReadOnly()}}t.TemperatureAdjustSlider=n,function(t){let i;!function(t){t.onUserInteractionFinished="onTemperatureAdjustSliderUserInteractionFinished",t.onShowDisplays="onTemperatureAdjustSliderShowDisplays",t.onHideDisplays="onTemperatureAdjustSliderHideDisplays"}(i=t.TimeAdjustSliderEvents||(t.TimeAdjustSliderEvents={})),t.MinimumRoomTemperature=15,t.MaximumRoomTemperature=30,t.RoomTemperatureAdjustStep=.5,t.DisplayRoomTemperatureRole=e.BA.Role.eAdvanced,t.DisplayRoomTemperatureLimitsRole=e.BA.Role.eAdvanced,t.DisplayControllerOutputRole=e.BA.Role.eAdvanced,t.DisplayRoomTemperatureAdjustRole=e.BA.Role.eAdvanced,t.EditLevel=e.BA.Role.eBasic}(n=t.TemperatureAdjustSlider||(t.TemperatureAdjustSlider={}))}(s=o.HeatingCooling||(o.HeatingCooling={}))}(i.RoomAutomation||(i.RoomAutomation={}))}(e.Controls||(e.Controls={}))}(t.BuildingAutomation||(t.BuildingAutomation={}))}(TcHmi||(TcHmi={})),TcHmi.Controls.registerEx("HeatingCooling","TcHmi.BuildingAutomation.Controls.RoomAutomation",TcHmi.BuildingAutomation.Controls.RoomAutomation.HeatingCooling);